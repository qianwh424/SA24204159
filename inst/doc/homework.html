<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="WenHan Qian" />

<meta name="date" content="2024-12-08" />

<title>All my homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">All my homework</h1>
<h4 class="author">WenHan Qian</h4>
<h4 class="date">2024-12-08</h4>



<div id="第一次作业" class="section level1">
<h1>第一次作业</h1>
<div id="第一次第一题" class="section level2">
<h2>第一次第一题</h2>
<p>The Rayleigh density [156, Ch. 18] is <span class="math display">\[f(x) = \frac{x}{\sigma^2}
e^{-\frac{x^2}{2\sigma^2}}, \quad x \geq 0, \, \sigma &gt;
0.\]</span></p>
<p>Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution. Generate
Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for
several choices of <span class="math inline">\(\sigma&gt;0\)</span> and
check that the mode of the generated samples is close to the theoretical
mode <span class="math inline">\(\sigma\)</span> (check the
histogram).</p>
<p>我们使用逆分布法，先生成均匀分布的随机数，再通过Rayleigh分布的累积分布函数的反函数进行转换。Rayleigh分布的累积分布函数为：
<span class="math display">\[F(x) = 1 -
e^{-\frac{x^2}{2\sigma^2}}\]</span> 我们用以下的公式生成Rayleigh随机样本
<span class="math display">\[X = \sigma \sqrt{-2 \log(1 -
U)}\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># 逆分布法生成Rayleigh分布随机数的函数</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="co"># 生成n个[0, 1)区间的均匀随机数</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="co"># 使用逆分布函数公式生成Rayleigh分布的随机数</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u))</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>}</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)  <span class="co"># σ的不同取值</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 每次生成的样本数量</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co"># 生成Rayleigh分布样本并绘制直方图</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">length</span>(sigma)))  <span class="co"># 设置多图布局</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigma) {</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  <span class="co"># 生成样本</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">rayleigh</span>(n, sigma)</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  </span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  <span class="co"># 绘制直方图</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  <span class="fu">hist</span>(samples, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">col =</span> <span class="st">&quot;mediumseagreen&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Rayleigh(σ=&quot;</span>, sigma, <span class="st">&quot;)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>), </span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;频率&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> sigma, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">paste</span>(<span class="st">&quot;理论众数: σ =&quot;</span>, sigma), </span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>         <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>  }</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>对密度函数求导可得理论的众数应为<span class="math inline">\(\sigma\)</span>，观察直方图可知这符合我们的估计</p>
</div>
<div id="第一次第二题" class="section level2">
<h2>第一次第二题</h2>
<p>问题描述如下：Generate a random sample of size 1000 from a normal
location mixture. The components of the mixture have N(0, 1) and N(3, 1)
distributions with mixing probabilities p1 and p2 = 1 − p1. Graph the
histogram of the sample with density superimposed, for p1 = 0.75. Repeat
with different values for p1 and observe whether the empirical
distribution of the mixture appears to be bimodal. Make a conjecture
about the values of p1 that produce bimodal mixtures</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># 混合正态分布样本生成函数</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>generate_mixture <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p1, mu1, mu2, sigma1, sigma2) {</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="co"># 生成n个均匀分布的随机数用于决定成分</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="co"># 使用混合概率p1选择不同成分的样本</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(u <span class="sc">&lt;</span> p1, <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mu1, <span class="at">sd =</span> sigma1), <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mu2, <span class="at">sd =</span> sigma2))</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>}</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">1000</span>   </span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span>            </span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">3</span>            </span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span>         </span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span>         </span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co"># 生成混合分布样本</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>p1_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.5</span>, <span class="fl">0.25</span>)  <span class="co"># 不同的 p1 值</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">length</span>(p1_values)))  <span class="co"># 设置多图布局</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="cf">for</span> (p1 <span class="cf">in</span> p1_values) {</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>  <span class="co"># 生成混合分布样本</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">generate_mixture</span>(n_samples, p1, mu1, mu2, sigma1, sigma2)</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>  </span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>  <span class="co"># 绘制样本的直方图</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>  <span class="fu">hist</span>(samples, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">&quot;mediumseagreen&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;p1 =&quot;</span>, p1), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;频率&quot;</span>)</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>  <span class="co"># 添加正态分布密度函数的叠加线</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>  <span class="fu">curve</span>(p1 <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mu1, <span class="at">sd =</span> sigma1) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p1) <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mu2, <span class="at">sd =</span> sigma2), </span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>}</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>可以从图中看出，当p1=0.5时双峰效应最明显，猜测p1越靠近0或者1，则双峰效应越不明显</p>
</div>
<div id="第一次第三题" class="section level2">
<h2>第一次第三题</h2>
<p>问题描述如下： A compound Poisson process is a stochastic process
<span class="math inline">\(\{X(t),t\geq0\}\)</span> that can be
represented as the random <span class="math inline">\(X(t)=\sum_{i=1}^{N(t)}Y_i, t\geq0\)</span>, where
<span class="math inline">\(\{N(t),t\geq0\}\)</span> is a Poisson
process and <span class="math inline">\(Y_1,Y_2,\ldots\)</span> iid and
independent of <span class="math inline">\(\{N(t),t\geq0\}\)</span>.
Write a program to simulate a compound Poisson(λ)–Gamma process (Y has a
Gamma distribution). Estimate the mean and the variance of X(10) for
several choices of the parameters and compare with the theoretical
values.</p>
<p>我们首先选用的参数如下:<span class="math inline">\(\lambda=1\)</span>,<span class="math inline">\(\alpha=1\)</span>,<span class="math inline">\(\beta=1\)</span>,模拟次数<span class="math inline">\(num=10000\)</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># 泊松过程的参数 </span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span>   <span class="co"># Gamma分布的形状参数</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span>    <span class="co"># Gamma分布的尺度参数</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span>       <span class="co"># 时间点 X(t)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># 模拟次数</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"># 模拟复合泊松-伽马过程</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>X_t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num)</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num) {</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> t)</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>  <span class="cf">if</span> (N_t <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t, <span class="at">shape =</span> alpha, <span class="at">rate =</span> beta)</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>    X_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>    X_t[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  }</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>}</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co"># 估计 X(t) 的均值和方差</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>e_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_t)</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>e_variance <span class="ot">&lt;-</span> <span class="fu">var</span>(X_t)</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co"># 理论均值和方差</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>E_Y1 <span class="ot">&lt;-</span> alpha <span class="sc">/</span> beta</span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>E_Y1_square <span class="ot">&lt;-</span> (alpha <span class="sc">*</span> (alpha <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">/</span> (beta <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>t_mean <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> E_Y1</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>t_variance <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> E_Y1_square</span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的均值:&quot;</span>, e_mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的均值: 9.993612</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论的均值:&quot;</span>, t_mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论的均值: 10</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的方差:&quot;</span>, e_variance, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的方差: 19.79653</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论的方差:&quot;</span>, t_variance, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论的方差: 20</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># 绘制直方图</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">hist</span>(X_t, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">&quot;mediumseagreen&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>, <span class="at">main =</span> <span class="st">&quot;直方图 (复合泊松-伽马过程)&quot;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X(10)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;频率&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>可以从上面的数据看出，在模拟次数为10000时，估计的方差和均值和理论的方差均值很接近。下面将改变模拟次数和分布参数给出另外两个例子</p>
<p>第二次选用的参数如下:<span class="math inline">\(\lambda=1\)</span>,<span class="math inline">\(\alpha=1\)</span>,<span class="math inline">\(\beta=1\)</span>,模拟次数<span class="math inline">\(num=1000\)</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># 设置种子</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># 泊松过程的参数 </span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span>   <span class="co"># Gamma分布的形状参数</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span>    <span class="co"># Gamma分布的尺度参数</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span>       <span class="co"># 时间点 X(t)</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co"># 模拟次数</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co"># 模拟复合泊松-伽马过程</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>X_t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num) {</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>  N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> t)</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>  <span class="cf">if</span> (N_t <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t, <span class="at">shape =</span> alpha, <span class="at">rate =</span> beta)</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>    X_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>    X_t[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>  }</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>}</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co"># 估计 X(t) 的均值和方差</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>e_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_t)</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>e_variance <span class="ot">&lt;-</span> <span class="fu">var</span>(X_t)</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co"># 理论均值和方差</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>E_Y1 <span class="ot">&lt;-</span> alpha <span class="sc">/</span> beta</span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>E_Y1_square <span class="ot">&lt;-</span> (alpha <span class="sc">*</span> (alpha <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">/</span> (beta <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>t_mean <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> E_Y1</span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>t_variance <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> E_Y1_square</span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的均值:&quot;</span>, e_mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的均值: 10.04342</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论的均值:&quot;</span>, t_mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论的均值: 10</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的方差:&quot;</span>, e_variance, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的方差: 20.31624</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论的方差:&quot;</span>, t_variance, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论的方差: 20</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># 绘制直方图</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">hist</span>(X_t, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">&quot;mediumseagreen&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>, <span class="at">main =</span> <span class="st">&quot;直方图 (复合泊松-伽马过程)&quot;</span>,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X(10)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;频率&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>可以发现随着模拟次数的减少，此时估计值和理论值的差值变大了一个数量级</p>
<p>第三次选用的参数如下:<span class="math inline">\(\lambda=2\)</span>,<span class="math inline">\(\alpha=2\)</span>,<span class="math inline">\(\beta=1\)</span>,模拟次数<span class="math inline">\(num=10000\)</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># 设置种子</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span>  <span class="co"># 泊松过程的参数 </span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span>   <span class="co"># Gamma分布的形状参数</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span>    <span class="co"># Gamma分布的尺度参数</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span>       <span class="co"># 时间点 X(t)</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co"># 模拟次数</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co"># 模拟复合泊松-伽马过程</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>X_t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num)</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num) {</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>  N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> t)</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>  <span class="cf">if</span> (N_t <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t, <span class="at">shape =</span> alpha, <span class="at">rate =</span> beta)</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>    X_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>    X_t[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a>  }</span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>}</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="co"># 估计 X(t) 的均值和方差</span></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a>e_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_t)</span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a>e_variance <span class="ot">&lt;-</span> <span class="fu">var</span>(X_t)</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a><span class="co"># 理论均值和方差</span></span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a>E_Y1 <span class="ot">&lt;-</span> alpha <span class="sc">/</span> beta</span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a>E_Y1_square <span class="ot">&lt;-</span> (alpha <span class="sc">*</span> (alpha <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">/</span> (beta <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a>t_mean <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> E_Y1</span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a>t_variance <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> E_Y1_square</span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a></span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb21-37"><a href="#cb21-37" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的均值:&quot;</span>, e_mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的均值: 39.97219</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论的均值:&quot;</span>, t_mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论的均值: 40</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的方差:&quot;</span>, e_variance, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的方差: 117.9874</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论的方差:&quot;</span>, t_variance, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论的方差: 120</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># 绘制直方图</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="fu">hist</span>(X_t, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">&quot;mediumseagreen&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>, <span class="at">main =</span> <span class="st">&quot;直方图 (复合泊松-伽马过程)&quot;</span>,</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X(10)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;频率&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="第二次作业" class="section level1">
<h1>第二次作业</h1>
<div id="第二次第一题" class="section level2">
<h2>第二次第一题</h2>
<p>问题描述如下：Write a function to compute a Monte Carlo estimate of
the Beta(3, 3) cdf, and use the function to estimate F(x) for x = 0.1,
0.2,…, 0.9. Compare the estimates with the values returned by the pbeta
function in R.</p>
<p>我们使用以下的函数来进行蒙特卡洛估计</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>beta_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">100000</span>) {</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  <span class="co"># 生成n_sim个Beta(3, 3)分布的随机样本</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  beta_samples <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  </span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  <span class="co"># 计算CDF的Monte Carlo估计</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  cdf_estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(beta_samples <span class="sc">&lt;=</span> x)</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  </span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  <span class="fu">return</span>(cdf_estimate)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>}</span></code></pre></div>
<p>取x=0.1,0.2,<span class="math inline">\(\cdots\)</span>,0.9</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>mc_estimates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x_values,beta_cdf)</span></code></pre></div>
<p>使用pbeta函数计算Beta(3, 3)的CDF值，并比较Monte
Carlo估计和pbeta函数的结果</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>pbeta_values <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x_values, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_values, </span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>                         <span class="at">Monte_Carlo_Estimate =</span> mc_estimates, </span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>                         <span class="at">pbeta_Value =</span> pbeta_values)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div>
<pre><code>##     x Monte_Carlo_Estimate pbeta_Value
## 1 0.1              0.00834     0.00856
## 2 0.2              0.05810     0.05792
## 3 0.3              0.16403     0.16308
## 4 0.4              0.31906     0.31744
## 5 0.5              0.49890     0.50000
## 6 0.6              0.68410     0.68256
## 7 0.7              0.83833     0.83692
## 8 0.8              0.94218     0.94208
## 9 0.9              0.99171     0.99144</code></pre>
</div>
<div id="第二次第二题" class="section level2">
<h2>第二次第二题</h2>
<p>问题描述如下：The Rayleigh density [156, (18.76)] is <span class="math display">\[f(x)=\frac{x}{\sigma^2}
e^{-x^2/(2\sigma^2)},\quad x\geq0, \sigma&gt;0.\]</span> Implement a
function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution, using antithetic
variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>?</p>
<p>我们先构造生成Rayleigh分布的独立样本</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>generate_rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)  <span class="co"># 生成n个均匀分布的随机数</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U))  <span class="co"># 生成n个Rayleigh分布的随机数</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>}</span></code></pre></div>
<p>再构造用于生成Rayleigh分布的对偶变量样本</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>generate_rayleigh_antithetic <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n <span class="sc">/</span> <span class="dv">2</span>)  <span class="co"># 生成一半的均匀分布随机数</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  U_antithetic <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> U  <span class="co"># 对偶变量</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U))  <span class="co"># 原始样本</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U_antithetic))  <span class="co"># 对偶样本</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(X1, X2))  </span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>}</span></code></pre></div>
<p>接下来计算对偶变量<span class="math inline">\(\frac{X+X&#39;}{2}\)</span>相对于<span class="math inline">\(\frac{X_1+X_2}{2}\)</span>的方差减少百分比</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 样本数量</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Rayleigh分布的参数</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="co"># 生成独立的Rayleigh分布样本</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">generate_rayleigh</span>(n, sigma)</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">generate_rayleigh</span>(n, sigma)</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>X_antithetic <span class="ot">&lt;-</span> <span class="fu">generate_rayleigh_antithetic</span>(n, sigma)</span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">var</span>((X1<span class="sc">+</span>X2)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">var</span>((X_antithetic[[<span class="dv">1</span>]]<span class="sc">+</span>X_antithetic[[<span class="dv">2</span>]])<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>percent_reduction <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (var1 <span class="sc">-</span> var2) <span class="sc">/</span> var1</span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;方差减少百分比为:&quot;</span>, percent_reduction, <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 方差减少百分比为: 94.84389 %</code></pre>
</div>
<div id="第二次第三题" class="section level2">
<h2>第二次第三题</h2>
<p>问题描述如下：Find two importance functions f1 and f2 that are
supported on (1, ∞) and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2},\quad
x&gt;1.\]</span> Which of your two importance functions should produce
the smaller variance in estimating <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}
dx\]</span> by importance sampling? Explain</p>
<p>我们选择了两种重要性函数，分别是：(1)X+1，其中X服从指数分布；(2)|X|+1，其中X服从标准正态分布</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a><span class="co"># 定义目标函数 g(x)</span></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>}</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a><span class="co"># 修改后的指数分布作为 f1，定义域在 (1, ∞)</span></span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>f1_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">lambda =</span> <span class="dv">1</span>) {</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&gt;=</span> <span class="dv">1</span>, lambda <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> (x <span class="sc">-</span> <span class="dv">1</span>)), <span class="dv">0</span>)</span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a>}</span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a><span class="co"># 标准正态分布的 |X|+1 作为 f2，定义域在 (1, ∞)</span></span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a>f2_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&gt;=</span> <span class="dv">1</span>, <span class="fu">dnorm</span>(x <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">dnorm</span>(<span class="sc">-</span>(x <span class="sc">-</span> <span class="dv">1</span>)), <span class="dv">0</span>)</span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a>}</span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a><span class="co"># 采样 f1</span></span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a>f1_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">lambda =</span> <span class="dv">1</span>) {</span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a>  <span class="fu">rexp</span>(n, <span class="at">rate =</span> lambda) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb38-21"><a href="#cb38-21" tabindex="-1"></a>}</span>
<span id="cb38-22"><a href="#cb38-22" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" tabindex="-1"></a><span class="co"># 采样 f2</span></span>
<span id="cb38-24"><a href="#cb38-24" tabindex="-1"></a>f2_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb38-25"><a href="#cb38-25" tabindex="-1"></a>  <span class="fu">abs</span>(<span class="fu">rnorm</span>(n)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb38-26"><a href="#cb38-26" tabindex="-1"></a>}</span>
<span id="cb38-27"><a href="#cb38-27" tabindex="-1"></a></span>
<span id="cb38-28"><a href="#cb38-28" tabindex="-1"></a><span class="co"># 重要性采样估计积分</span></span>
<span id="cb38-29"><a href="#cb38-29" tabindex="-1"></a>importance_sampling <span class="ot">&lt;-</span> <span class="cf">function</span>(n, f_sample, f_density) {</span>
<span id="cb38-30"><a href="#cb38-30" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">f_sample</span>(n)</span>
<span id="cb38-31"><a href="#cb38-31" tabindex="-1"></a>  h_x <span class="ot">&lt;-</span> <span class="fu">g</span>(x)</span>
<span id="cb38-32"><a href="#cb38-32" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> h_x <span class="sc">/</span> <span class="fu">f_density</span>(x)</span>
<span id="cb38-33"><a href="#cb38-33" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">var=</span><span class="fu">var</span>(weights),<span class="at">mean=</span><span class="fu">mean</span>(weights)))</span>
<span id="cb38-34"><a href="#cb38-34" tabindex="-1"></a>}</span>
<span id="cb38-35"><a href="#cb38-35" tabindex="-1"></a></span>
<span id="cb38-36"><a href="#cb38-36" tabindex="-1"></a><span class="co"># 设置采样数量</span></span>
<span id="cb38-37"><a href="#cb38-37" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb38-38"><a href="#cb38-38" tabindex="-1"></a></span>
<span id="cb38-39"><a href="#cb38-39" tabindex="-1"></a><span class="co"># 对 f1 进行重要性采样估计</span></span>
<span id="cb38-40"><a href="#cb38-40" tabindex="-1"></a>estimate_f1 <span class="ot">&lt;-</span> <span class="fu">importance_sampling</span>(n, f1_sample, f1_density)</span>
<span id="cb38-41"><a href="#cb38-41" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;使用 f1 (X+1，X为指数分布) 的估计值：&quot;</span>, estimate_f1<span class="sc">$</span>mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 使用 f1 (X+1，X为指数分布) 的估计值： 0.399765</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;使用 f1 (X+1，X为指数分布) 的方差：&quot;</span>, estimate_f1<span class="sc">$</span>var, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 使用 f1 (X+1，X为指数分布) 的方差： 0.02491508</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="co"># 对 f2 进行重要性采样估计</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>estimate_f2 <span class="ot">&lt;-</span> <span class="fu">importance_sampling</span>(n, f2_sample, f2_density)</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;使用 f2 (|X|+1，X为标准正态分布) 的估计值：&quot;</span>, estimate_f2<span class="sc">$</span>mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 使用 f2 (|X|+1，X为标准正态分布) 的估计值： 0.4009521</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;使用 f2 (|X|+1，X为标准正态分布) 的方差：&quot;</span>, estimate_f2<span class="sc">$</span>var, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 使用 f2 (|X|+1，X为标准正态分布) 的方差： 0.001919867</code></pre>
<p>可以看出，使用修改后的正态分布所产生的方差远小于使用修改过的指数分布所产生的方差，对比他们的密度函数，我们可以画出下面的图像：</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a><span class="co"># 定义目标函数 g(x)</span></span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>}</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a><span class="co"># 修改后的指数分布作为 f1，定义域在 (1, ∞)</span></span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>f1_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">lambda =</span> <span class="dv">1</span>) {</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&gt;=</span> <span class="dv">1</span>, lambda <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> (x <span class="sc">-</span> <span class="dv">1</span>)), <span class="dv">0</span>)</span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>}</span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a><span class="co"># 标准正态分布的 |X|+1 作为 f2，定义域在 (1, ∞)</span></span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>f2_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&gt;=</span> <span class="dv">1</span>, <span class="fu">dnorm</span>(x <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">dnorm</span>(<span class="sc">-</span>(x <span class="sc">-</span> <span class="dv">1</span>)), <span class="dv">0</span>)</span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>}</span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a><span class="co"># 生成绘图范围</span></span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb46-21"><a href="#cb46-21" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" tabindex="-1"></a><span class="co"># 计算密度值</span></span>
<span id="cb46-23"><a href="#cb46-23" tabindex="-1"></a>g_vals <span class="ot">&lt;-</span> <span class="fu">g</span>(x_vals)</span>
<span id="cb46-24"><a href="#cb46-24" tabindex="-1"></a>f1_vals <span class="ot">&lt;-</span> <span class="fu">f1_density</span>(x_vals)</span>
<span id="cb46-25"><a href="#cb46-25" tabindex="-1"></a>f2_vals <span class="ot">&lt;-</span> <span class="fu">f2_density</span>(x_vals)</span>
<span id="cb46-26"><a href="#cb46-26" tabindex="-1"></a></span>
<span id="cb46-27"><a href="#cb46-27" tabindex="-1"></a><span class="co"># 创建数据框用于绘图</span></span>
<span id="cb46-28"><a href="#cb46-28" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb46-29"><a href="#cb46-29" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(x_vals, <span class="dv">3</span>),</span>
<span id="cb46-30"><a href="#cb46-30" tabindex="-1"></a>  <span class="at">density =</span> <span class="fu">c</span>(g_vals, f1_vals, f2_vals),</span>
<span id="cb46-31"><a href="#cb46-31" tabindex="-1"></a>  <span class="at">function_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>, <span class="st">&quot;f1&quot;</span>, <span class="st">&quot;f2&quot;</span>), <span class="at">each =</span> <span class="fu">length</span>(x_vals))</span>
<span id="cb46-32"><a href="#cb46-32" tabindex="-1"></a>)</span>
<span id="cb46-33"><a href="#cb46-33" tabindex="-1"></a></span>
<span id="cb46-34"><a href="#cb46-34" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb46-35"><a href="#cb46-35" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density, <span class="at">color =</span> function_type)) <span class="sc">+</span></span>
<span id="cb46-36"><a href="#cb46-36" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-37"><a href="#cb46-37" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Density Functions: g(x), f1, and f2&quot;</span>,</span>
<span id="cb46-38"><a href="#cb46-38" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;x&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-39"><a href="#cb46-39" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;f1&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;f2&quot;</span> <span class="ot">=</span> <span class="st">&quot;green&quot;</span>)) <span class="sc">+</span></span>
<span id="cb46-40"><a href="#cb46-40" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>可以发现，由修改过的正态分布所得到的密度函数与g函数的密度更接近，选择塔作为重要性函数所产生的方差页更小，这与我们的模拟结论是相符的。</p>
</div>
<div id="第二次第四题" class="section level2">
<h2>第二次第四题</h2>
<p>问题描述为：For <span class="math inline">\(n = 10^4, 2 × 10^4, 4 ×
10^4, 6 × 10^4, 8 × 10^4\)</span>, apply the fast sorting algorithm to
randomly permuted numbers of 1, <span class="math inline">\(\ldots\)</span>, n. Calculate computation time
averaged over 100 simulations, denoted by <span class="math inline">\(a_n\)</span>. Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n=n*log(n)\)</span>, and graphically show the
results(scatter plot and regression line).</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="co"># 定义快速排序函数</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>quick_sort <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>) {</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>    pivot <span class="ot">&lt;-</span> x[<span class="dv">1</span>]  <span class="co"># 选择第一个元素作为基准</span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>    less <span class="ot">&lt;-</span> x[x <span class="sc">&lt;</span> pivot]  <span class="co"># 小于基准的元素</span></span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>    greater <span class="ot">&lt;-</span> x[x <span class="sc">&gt;</span> pivot]  <span class="co"># 大于基准的元素</span></span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>    equal <span class="ot">&lt;-</span> x[x <span class="sc">==</span> pivot]  <span class="co"># 等于基准的元素</span></span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(less), equal, <span class="fu">quick_sort</span>(greater)))  <span class="co"># 递归排序</span></span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>  }</span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>}</span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a><span class="co"># 定义 n 的值</span></span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a><span class="co"># 设置重复次数</span></span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a><span class="co"># 初始化存储平均排序时间的向量</span></span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a>a_n <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n_values))</span>
<span id="cb47-24"><a href="#cb47-24" tabindex="-1"></a></span>
<span id="cb47-25"><a href="#cb47-25" tabindex="-1"></a><span class="co"># 测量排序时间的函数</span></span>
<span id="cb47-26"><a href="#cb47-26" tabindex="-1"></a>measure_sort_time <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb47-27"><a href="#cb47-27" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_simulations)</span>
<span id="cb47-28"><a href="#cb47-28" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_simulations) {</span>
<span id="cb47-29"><a href="#cb47-29" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)  <span class="co"># 生成随机排列</span></span>
<span id="cb47-30"><a href="#cb47-30" tabindex="-1"></a>    start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb47-31"><a href="#cb47-31" tabindex="-1"></a>    sorted_x <span class="ot">&lt;-</span> <span class="fu">quick_sort</span>(x)  <span class="co"># 使用自定义的快速排序</span></span>
<span id="cb47-32"><a href="#cb47-32" tabindex="-1"></a>    end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb47-33"><a href="#cb47-33" tabindex="-1"></a>    times[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(end_time, start_time, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>))  <span class="co"># 记录时间</span></span>
<span id="cb47-34"><a href="#cb47-34" tabindex="-1"></a>  }</span>
<span id="cb47-35"><a href="#cb47-35" tabindex="-1"></a>  <span class="fu">mean</span>(times)  <span class="co"># 返回平均时间</span></span>
<span id="cb47-36"><a href="#cb47-36" tabindex="-1"></a>}</span>
<span id="cb47-37"><a href="#cb47-37" tabindex="-1"></a></span>
<span id="cb47-38"><a href="#cb47-38" tabindex="-1"></a><span class="co"># 计算每个 n 的平均排序时间</span></span>
<span id="cb47-39"><a href="#cb47-39" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(n_values)) {</span>
<span id="cb47-40"><a href="#cb47-40" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n_values[i]</span>
<span id="cb47-41"><a href="#cb47-41" tabindex="-1"></a>  a_n[i] <span class="ot">&lt;-</span> <span class="fu">measure_sort_time</span>(n)</span>
<span id="cb47-42"><a href="#cb47-42" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;n =&quot;</span>, n, <span class="st">&quot;的平均排序时间:&quot;</span>, a_n[i], <span class="st">&quot;秒</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb47-43"><a href="#cb47-43" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## n = 10000 的平均排序时间: 0.02012495 秒
## n = 20000 的平均排序时间: 0.0347965 秒
## n = 40000 的平均排序时间: 0.06872766 秒
## n = 60000 的平均排序时间: 0.1044069 秒
## n = 80000 的平均排序时间: 0.1418665 秒</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># 计算 tn = n * log(n)</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>t_n <span class="ot">&lt;-</span> n_values <span class="sc">*</span> <span class="fu">log</span>(n_values)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a><span class="co"># 绘制散点图和回归线</span></span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n_values =</span> n_values, <span class="at">t_n =</span> t_n, <span class="at">a_n =</span> a_n)</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> t_n, <span class="at">y =</span> a_n)) <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;快速排序计算时间与 n log(n) 的关系&quot;</span>,</span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;n * log(n)&quot;</span>,</span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;平均排序时间 (秒)&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="第三次作业" class="section level1">
<h1>第三次作业</h1>
<div id="第三次第一题" class="section level2">
<h2>第三次第一题</h2>
<p>题目描述为：Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of
the skewness <span class="math inline">\(\sqrt{b_1}\)</span> under
normality by a Monte Carlo experiment. Compute the standard error of the
estimates from (2.14) using the normal approximation for the density
(with exact variance formula). Compare the estimated quantiles with the
quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_1}\)</span> ≈ N(0, 6/n).</p>
<p>首先，我们给出在正态性假设下的偏度估计量：</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 样本大小</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Monte Carlo模拟次数</span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)  <span class="co"># 固定随机种子</span></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a><span class="co"># 定义计算偏度的函数</span></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>  mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>  s3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> mean_x)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> mean_x)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>  <span class="fu">return</span>(s3 <span class="sc">/</span> s2)</span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a>}</span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a><span class="co"># Monte Carlo模拟</span></span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a>skew_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  <span class="co"># 存储偏度的结果</span></span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)  <span class="co"># 从标准正态分布中生成样本</span></span>
<span id="cb51-19"><a href="#cb51-19" tabindex="-1"></a>  skew_values[i] <span class="ot">&lt;-</span> <span class="fu">skewness</span>(sample_data)</span>
<span id="cb51-20"><a href="#cb51-20" tabindex="-1"></a>}</span></code></pre></div>
<p>将估计的分位数和大样本近似的分位数进行比较</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(skew_values, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>))</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的分位数为：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的分位数为：</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">print</span>(quantiles)</span></code></pre></div>
<pre><code>##        2.5%          5%         95%       97.5% 
## -0.04799941 -0.04002108  0.04090775  0.04817854</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>var_formula <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n)</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论分位数为：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论分位数为：</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>theoretical_quantiles <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> var_formula)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="fu">print</span>(theoretical_quantiles)</span></code></pre></div>
<pre><code>## [1] -0.04800912 -0.04029052  0.04029052  0.04800912</code></pre>
<p>利用密度的正态近似计算的估计值的标准误差如下所示：</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>skew_se_values <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(q<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>q)<span class="sc">/</span>(n<span class="sc">*</span>(<span class="fu">dnorm</span>(<span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> var_formula),<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> var_formula)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a><span class="fu">print</span>(skew_se_values)</span></code></pre></div>
<pre><code>## [1] 0.0006543349 0.0005176231 0.0005176231 0.0006543349</code></pre>
</div>
<div id="第三次第二题" class="section level2">
<h2>第三次第二题</h2>
<p>题目描述如下：Tests for association based on Pearson product moment
correlation <span class="math inline">\(\rho\)</span>, Spearman’s rank
correlation coefficient <span class="math inline">\(\rho_s\)</span>, or
Kendall’s coefficient <span class="math inline">\(\tau\)</span>, are
implemented in . Show (empirically) that the nonparametric tests based
on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution <span class="math inline">\((X, Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests have better empirical power than the
correlation test against this alternative.</p>
<p>经过测试，当数据对<span class="math inline">\((X,
\sqrt{|Y|})\)</span>满足<span class="math inline">\((X,
Y)\)</span>服从均值为0，协方差矩阵为<span class="math display">\[
\Sigma = \begin{bmatrix}
1 &amp; 0.01 \\
0.01 &amp; 1
\end{bmatrix}
\]</span>的二元正态分布时，Spearman检验功效和Kendall检验功效均大于Pearson检验功效</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="fu">library</span>(MASS)  <span class="co"># 用于生成双变量正态分布数据</span></span></code></pre></div>
<pre><code>## Warning: package &#39;MASS&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a><span class="co"># 设置随机数种子</span></span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)  <span class="co"># 均值向量</span></span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)  <span class="co"># 协方差矩阵</span></span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># 样本大小</span></span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 模拟次数</span></span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a>p_vals_pearson <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a>p_vals_spearman <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a>p_vals_kendall <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb64-17"><a href="#cb64-17" tabindex="-1"></a></span>
<span id="cb64-18"><a href="#cb64-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb64-19"><a href="#cb64-19" tabindex="-1"></a>  data_sim <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, mu, Sigma)</span>
<span id="cb64-20"><a href="#cb64-20" tabindex="-1"></a>  p_vals_pearson[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data_sim[,<span class="dv">1</span>], <span class="fu">sqrt</span>(<span class="fu">abs</span>(data_sim[,<span class="dv">2</span>])), <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb64-21"><a href="#cb64-21" tabindex="-1"></a>  p_vals_spearman[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data_sim[,<span class="dv">1</span>], <span class="fu">sqrt</span>(<span class="fu">abs</span>(data_sim[,<span class="dv">2</span>])), <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb64-22"><a href="#cb64-22" tabindex="-1"></a>  p_vals_kendall[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data_sim[,<span class="dv">1</span>], <span class="fu">sqrt</span>(<span class="fu">abs</span>(data_sim[,<span class="dv">2</span>])), <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb64-23"><a href="#cb64-23" tabindex="-1"></a>}</span>
<span id="cb64-24"><a href="#cb64-24" tabindex="-1"></a></span>
<span id="cb64-25"><a href="#cb64-25" tabindex="-1"></a><span class="co"># 计算拒绝原假设的比例（即功效）</span></span>
<span id="cb64-26"><a href="#cb64-26" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb64-27"><a href="#cb64-27" tabindex="-1"></a>power_pearson <span class="ot">&lt;-</span> <span class="fu">mean</span>(p_vals_pearson <span class="sc">&lt;</span> alpha)</span>
<span id="cb64-28"><a href="#cb64-28" tabindex="-1"></a>power_spearman <span class="ot">&lt;-</span> <span class="fu">mean</span>(p_vals_spearman <span class="sc">&lt;</span> alpha)</span>
<span id="cb64-29"><a href="#cb64-29" tabindex="-1"></a>power_kendall <span class="ot">&lt;-</span> <span class="fu">mean</span>(p_vals_kendall <span class="sc">&lt;</span> alpha)</span>
<span id="cb64-30"><a href="#cb64-30" tabindex="-1"></a></span>
<span id="cb64-31"><a href="#cb64-31" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">功效比较：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 功效比较：</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Pearson检验功效：&quot;</span>, power_pearson, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Pearson检验功效： 0.0507</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman检验功效：&quot;</span>, power_spearman, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Spearman检验功效： 0.0531</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Kendall检验功效：&quot;</span>, power_kendall, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Kendall检验功效： 0.0529</code></pre>
</div>
<div id="第三次第三题" class="section level2">
<h2>第三次第三题</h2>
<p>问题描述为：If we obtain the powers for two methods under a
particular simulation setting with 10,000 experiments: say, 0.651 for
one method and 0.676 for another method. We want to know if the powers
are different at 0.05 level. What is the corresponding hypothesis test
problem? What test should we use? Z-test, two-sample t-test, paired-t
test or McNemar test? Why? Please provide the least necessary
information for hypothesis testing.</p>
<p>首先我们给出对应的假设检验问题：</p>
<p><span class="math inline">\(H_0:\)</span>
两种方法所得到的功效相同</p>
<p><span class="math inline">\(H_1:\)</span>
两种方法所得的的功效不同</p>
<p>然后我们选择Z检验作为我们的检验方式，因为我们对功效的分布没有更多的信息，而t检验主要用于比较较小分布下两个正态分布的样本均值是否有差异，配对t检验用于比较两组配对样本的均值差异，McNemar检验用于分析配对数据的分类变量。而我们拥有较大的样本数量，故选择Z检验比较合理，下面将使用Z检验进行检验。</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># 两个方法的统计功效</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>power1 <span class="ot">&lt;-</span> <span class="fl">0.651</span></span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>power2 <span class="ot">&lt;-</span> <span class="fl">0.676</span></span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a><span class="co"># 实验次数</span></span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a><span class="co"># 计算合并后的功效（pooled proportion）</span></span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>pooled_power <span class="ot">&lt;-</span> (power1 <span class="sc">+</span> power2) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a><span class="co"># 计算两比例差异的标准误</span></span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a>se_diff <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pooled_power <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pooled_power) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">/</span> n))</span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a></span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a><span class="co"># Z检验统计量</span></span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a>z_stat <span class="ot">&lt;-</span> (power1 <span class="sc">-</span> power2) <span class="sc">/</span> se_diff</span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a></span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a><span class="co"># 计算双尾检验的p值</span></span>
<span id="cb72-18"><a href="#cb72-18" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stat)))</span>
<span id="cb72-19"><a href="#cb72-19" tabindex="-1"></a></span>
<span id="cb72-20"><a href="#cb72-20" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb72-21"><a href="#cb72-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Z检验统计量:&quot;</span>, z_stat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Z检验统计量: -3.741209</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值: 0.0001831369</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="co"># 在0.05显著性水平下判断是否有显著差异</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;在0.05显著性水平上，两者功效有显著差异。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;在0.05显著性水平上，两者功效没有显著差异。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 在0.05显著性水平上，两者功效有显著差异。</code></pre>
<p>由上可知，我们在0.05显著水平下否认<span class="math inline">\(H_0\)</span></p>
</div>
</div>
<div id="第四次作业" class="section level1">
<h1>第四次作业</h1>
<div id="第四次第一题" class="section level2">
<h2>第四次第一题</h2>
<p>题目描述为：Of N = 1000 hypotheses, 950 are null and 50 are
alternative. The p-value under any null hypothesis is uniformly
distributed (use runif), and the p-value under any alternative
hypothesis follows the beta distribution with parameter 0.1 and 1 (use
rbeta). Obtain Bonferroni adjusted p-values and B-H adjusted p-values.
Calculate FWER, FDR, and TPR under nominal level α = 0.1 for each of the
two adjustment methods based on m = 10000 simulation replicates. You
should output the 6 numbers (3 ) to a 3 × 2 table (column names:
Bonferroni correction, B-H correction; row names: FWER, FDR, TPR).
Comment the results.</p>
<p>下面来计算这些值</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)  <span class="co"># 设置随机种子</span></span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 总假设数量</span></span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>null_hypotheses <span class="ot">&lt;-</span> <span class="dv">950</span>  <span class="co"># 零假设数量</span></span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>alt_hypotheses <span class="ot">&lt;-</span> <span class="dv">50</span>  <span class="co"># 备择假设数量</span></span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>  <span class="co"># 显著性水平</span></span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 模拟次数</span></span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a><span class="co">#初始化</span></span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a>bonferroni_fwer <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a>bonferroni_fdr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a>bonferroni_tpr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a>bh_fwer <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a>bh_fdr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a>bh_tpr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a></span>
<span id="cb78-16"><a href="#cb78-16" tabindex="-1"></a></span>
<span id="cb78-17"><a href="#cb78-17" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb78-18"><a href="#cb78-18" tabindex="-1"></a>  <span class="co"># 生成p值</span></span>
<span id="cb78-19"><a href="#cb78-19" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(null_hypotheses), <span class="fu">rbeta</span>(alt_hypotheses, <span class="fl">0.1</span>, <span class="dv">1</span>))</span>
<span id="cb78-20"><a href="#cb78-20" tabindex="-1"></a>  </span>
<span id="cb78-21"><a href="#cb78-21" tabindex="-1"></a>  <span class="co"># Bonferroni调整</span></span>
<span id="cb78-22"><a href="#cb78-22" tabindex="-1"></a>  bonferroni_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb78-23"><a href="#cb78-23" tabindex="-1"></a>  </span>
<span id="cb78-24"><a href="#cb78-24" tabindex="-1"></a>  <span class="co"># Benjamini-Hochberg调整</span></span>
<span id="cb78-25"><a href="#cb78-25" tabindex="-1"></a>  bh_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb78-26"><a href="#cb78-26" tabindex="-1"></a>  </span>
<span id="cb78-27"><a href="#cb78-27" tabindex="-1"></a>  <span class="co">#分别计算两种调整下的FWER, FDR, TPR</span></span>
<span id="cb78-28"><a href="#cb78-28" tabindex="-1"></a>  bonferroni_fwer[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(bonferroni_adjusted[<span class="dv">1</span><span class="sc">:</span>null_hypotheses] <span class="sc">&lt;</span> alpha)<span class="sc">&gt;=</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb78-29"><a href="#cb78-29" tabindex="-1"></a>  </span>
<span id="cb78-30"><a href="#cb78-30" tabindex="-1"></a>  bh_fwer[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(bh_adjusted[<span class="dv">1</span><span class="sc">:</span>null_hypotheses] <span class="sc">&lt;</span> alpha)<span class="sc">&gt;=</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb78-31"><a href="#cb78-31" tabindex="-1"></a>  </span>
<span id="cb78-32"><a href="#cb78-32" tabindex="-1"></a>  bonferroni_fdr[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(bonferroni_adjusted[<span class="dv">1</span><span class="sc">:</span>null_hypotheses] <span class="sc">&lt;</span> alpha)<span class="sc">/</span><span class="fu">sum</span>(bonferroni_adjusted[<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>] <span class="sc">&lt;</span> alpha)</span>
<span id="cb78-33"><a href="#cb78-33" tabindex="-1"></a>  </span>
<span id="cb78-34"><a href="#cb78-34" tabindex="-1"></a>  bh_fdr[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(bh_adjusted[<span class="dv">1</span><span class="sc">:</span>null_hypotheses] <span class="sc">&lt;</span> alpha)<span class="sc">/</span><span class="fu">sum</span>(bonferroni_adjusted[<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>] <span class="sc">&lt;</span> alpha)</span>
<span id="cb78-35"><a href="#cb78-35" tabindex="-1"></a>  </span>
<span id="cb78-36"><a href="#cb78-36" tabindex="-1"></a>  bonferroni_tpr[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(bonferroni_adjusted[(null_hypotheses<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1000</span>] <span class="sc">&lt;</span> alpha)<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb78-37"><a href="#cb78-37" tabindex="-1"></a>  </span>
<span id="cb78-38"><a href="#cb78-38" tabindex="-1"></a>  bh_tpr[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(bh_adjusted[(null_hypotheses<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1000</span>] <span class="sc">&lt;</span> alpha)<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb78-39"><a href="#cb78-39" tabindex="-1"></a>}</span>
<span id="cb78-40"><a href="#cb78-40" tabindex="-1"></a></span>
<span id="cb78-41"><a href="#cb78-41" tabindex="-1"></a><span class="co">#构造结果矩阵</span></span>
<span id="cb78-42"><a href="#cb78-42" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(bonferroni_fwer),<span class="fu">mean</span>(bonferroni_fdr),<span class="fu">mean</span>(bonferroni_tpr),<span class="fu">mean</span>(bh_fwer),<span class="fu">mean</span>(bh_fdr),<span class="fu">mean</span>(bh_tpr)),<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb78-43"><a href="#cb78-43" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&quot;Bonferroni correction&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>)</span>
<span id="cb78-44"><a href="#cb78-44" tabindex="-1"></a><span class="fu">rownames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>,<span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb78-45"><a href="#cb78-45" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>##      Bonferroni correction B-H correction
## FWER           0.091800000      0.9338000
## FDR            0.004816463      0.1570625
## TPR            0.398074000      0.5629740</code></pre>
<p>从表格中可以看出，对于Bonferroni调整更保守，导致了较低的FWER，TPR和FDR，因为它严格控制FWER。B-H方法相对宽松，可能提高TPR和FDR，但FWER控制较弱。</p>
</div>
<div id="第四次第二题" class="section level2">
<h2>第四次第二题</h2>
<p>题目描述为：Refer to the air-conditioning data set aircondit provided
in the boot package. The 12 observations are the times in hours between
failures of airconditioning equipment [63, Example 1.1]: 3, 5, 7, 18,
43, 85, 91, 98, 100, 130, 230, 487. Assume that the times between
failures follow an exponential model Exp(λ). Obtain the MLE of the
hazard rate λ and use bootstrap to estimate the bias and standard error
of the estimate.</p>
<p>我们容易得到对数似然函数为： <span class="math display">\[l(\lambda)
= n\, log(\lambda) - \lambda\sum_{i=1}^{n}{x_i}\]</span></p>
<p>解得<span class="math inline">\(\lambda\)</span>的估计量为<span class="math inline">\(\frac{n}{\sum_{i=1}^n{x_i}}\)</span></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="co"># 加载boot包并查看数据</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## Warning: package &#39;boot&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;aircondit&quot;</span>)</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a><span class="co"># 取出数据</span></span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>fail_times <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a><span class="co"># MLE估计</span></span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a><span class="co"># 在指数分布中，lambda的最大似然估计值是1/均值</span></span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(fail_times)</span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE of lambda:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MLE of lambda: 0.00925212</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="co"># 定义自助法函数</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>bootstrap_mle <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(sample_data))  <span class="co"># 重新计算样本的lambda估计值</span></span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a>}</span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a><span class="co"># 使用boot包中的boot函数执行自助法</span></span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> fail_times, <span class="at">statistic =</span> bootstrap_mle, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a></span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a><span class="co"># 计算偏差和标准误差</span></span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a>lambda_bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_results<span class="sc">$</span>t) <span class="sc">-</span> lambda_mle</span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a>lambda_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_results<span class="sc">$</span>t)</span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a></span>
<span id="cb84-14"><a href="#cb84-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap bias estimate:&quot;</span>, lambda_bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Bootstrap bias estimate: 0.00132276</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap standard error estimate:&quot;</span>, lambda_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Bootstrap standard error estimate: 0.004423679</code></pre>
<p>由结果知，<span class="math inline">\(\lambda\)</span>的估计值为0.00925212，bootstrap的偏差为0.00132276，标准差也比较小。</p>
</div>
<div id="第四次第三题" class="section level2">
<h2>第四次第三题</h2>
<p>题目为： Refer to Exercise 7.4. Compute 95% bootstrap confidence
intervals for the mean time between failures 1/λ by the standard normal,
basic, percentile, and BCa methods. Compare the intervals and explain
why they may differ.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="co"># 加载必要的库</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a></span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a><span class="co"># 定义一个函数，用于计算平均故障时间 1/λ</span></span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>mean_time <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) { </span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(data[indices]))  <span class="co"># 返回 1/λ 即平均时间</span></span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a>}</span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" tabindex="-1"></a><span class="co"># 使用 bootstrapping 方法进行估计</span></span>
<span id="cb88-11"><a href="#cb88-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 确保结果可重复</span></span>
<span id="cb88-12"><a href="#cb88-12" tabindex="-1"></a>bootstrap_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, <span class="at">statistic =</span> mean_time, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb88-13"><a href="#cb88-13" tabindex="-1"></a></span>
<span id="cb88-14"><a href="#cb88-14" tabindex="-1"></a><span class="co"># 计算不同方法的95%置信区间</span></span>
<span id="cb88-15"><a href="#cb88-15" tabindex="-1"></a>ci_normal <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results, <span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)</span>
<span id="cb88-16"><a href="#cb88-16" tabindex="-1"></a>ci_basic <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results, <span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)</span>
<span id="cb88-17"><a href="#cb88-17" tabindex="-1"></a>ci_percentile <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results, <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb88-18"><a href="#cb88-18" tabindex="-1"></a>ci_bca <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)</span>
<span id="cb88-19"><a href="#cb88-19" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb88-21"><a href="#cb88-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;对于平均时间的95%置信区间为：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 对于平均时间的95%置信区间为：</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Normal Method CI: &quot;</span>, ci_normal<span class="sc">$</span>normal[<span class="dv">2</span>], <span class="st">&quot;to&quot;</span>, ci_normal<span class="sc">$</span>normal[<span class="dv">3</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Normal Method CI:  35.05313 to 182.4408</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Basic Method CI: &quot;</span>, ci_basic<span class="sc">$</span>basic[<span class="dv">4</span>], <span class="st">&quot;to&quot;</span>, ci_basic<span class="sc">$</span>basic[<span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Basic Method CI:  25.75417 to 170.0833</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Percentile Method CI: &quot;</span>, ci_percentile<span class="sc">$</span>percent[<span class="dv">4</span>], <span class="st">&quot;to&quot;</span>, ci_percentile<span class="sc">$</span>percent[<span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Percentile Method CI:  46.08333 to 190.4125</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BCa Method CI: &quot;</span>, ci_bca<span class="sc">$</span>bca[<span class="dv">4</span>], <span class="st">&quot;to&quot;</span>, ci_bca<span class="sc">$</span>bca[<span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## BCa Method CI:  56.16667 to 221.4406</code></pre>
<p>下面简单分析一下不同方法的差异：
标准正态方法基于正态近似，这在样本量大且分布接近正态时较为有效。
基本方法则是基于原始数据的bootstrap样本直接构造置信区间，可能对样本大小敏感。
百分位数方法直接使用bootstrap样本的分位数来构造置信区间，这种方法对极端值敏感。
BCa
方法经过校正的置信区间，结合了偏差和加速因素，通常表现出更好的覆盖率和更少的偏差。</p>
</div>
</div>
<div id="第五次作业" class="section level1">
<h1>第五次作业</h1>
<p>##第五次第一题</p>
<p>问题描述为：Refer to Exercise 7.7. Obtain the jackknife estimates of
bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="co"># 加载所需数据集</span></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>scores_data <span class="ot">&lt;-</span> scor</span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a><span class="co"># 计算总体的第一个特征值占比</span></span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>cov_eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scores_data))<span class="sc">$</span>values</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>initial_theta <span class="ot">&lt;-</span> cov_eigenvalues[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(cov_eigenvalues)</span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a><span class="co"># Jackknife估计</span></span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scores_data)</span>
<span id="cb98-11"><a href="#cb98-11" tabindex="-1"></a>theta_jackknife <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> num_samples)</span>
<span id="cb98-12"><a href="#cb98-12" tabindex="-1"></a></span>
<span id="cb98-13"><a href="#cb98-13" tabindex="-1"></a><span class="cf">for</span> (sample_index <span class="cf">in</span> <span class="fu">seq_len</span>(num_samples)) {</span>
<span id="cb98-14"><a href="#cb98-14" tabindex="-1"></a>  <span class="co"># 排除当前样本并计算协方差矩阵</span></span>
<span id="cb98-15"><a href="#cb98-15" tabindex="-1"></a>  reduced_cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(scores_data[<span class="sc">-</span>sample_index, ])</span>
<span id="cb98-16"><a href="#cb98-16" tabindex="-1"></a>  jackknife_eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(reduced_cov)<span class="sc">$</span>values</span>
<span id="cb98-17"><a href="#cb98-17" tabindex="-1"></a>  </span>
<span id="cb98-18"><a href="#cb98-18" tabindex="-1"></a>  <span class="co"># 计算特征值比例</span></span>
<span id="cb98-19"><a href="#cb98-19" tabindex="-1"></a>  theta_jackknife[sample_index] <span class="ot">&lt;-</span> jackknife_eigenvalues[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(jackknife_eigenvalues)</span>
<span id="cb98-20"><a href="#cb98-20" tabindex="-1"></a>}</span>
<span id="cb98-21"><a href="#cb98-21" tabindex="-1"></a></span>
<span id="cb98-22"><a href="#cb98-22" tabindex="-1"></a><span class="co"># 计算Jackknife的偏差和标准误</span></span>
<span id="cb98-23"><a href="#cb98-23" tabindex="-1"></a>jackknife_bias <span class="ot">&lt;-</span> (num_samples <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta_jackknife) <span class="sc">-</span> initial_theta)</span>
<span id="cb98-24"><a href="#cb98-24" tabindex="-1"></a>jackknife_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((num_samples <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta_jackknife <span class="sc">-</span> <span class="fu">mean</span>(theta_jackknife))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb98-25"><a href="#cb98-25" tabindex="-1"></a></span>
<span id="cb98-26"><a href="#cb98-26" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb98-27"><a href="#cb98-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Jackknife偏差估计:&quot;</span>, jackknife_bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Jackknife偏差估计: 0.001069139</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Jackknife标准误估计:&quot;</span>, jackknife_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Jackknife标准误估计: 0.04955231</code></pre>
<div id="第五次第二题" class="section level2">
<h2>第五次第二题</h2>
<p>问题描述为： In Example 7.18, leave-one-out (n-fold) cross validation
was used to select the best fitting model. Repeat the analysis replacing
the Log-Log model with a cubic polynomial model. Which of the four
models is selected by the cross validation procedure? Which model is
selected according to maximum adjusted <span class="math inline">\(X^2\)</span>?</p>
<p>三次多项式模型为： <span class="math display">\[Y=\beta_0+\beta_1X+\beta_2X^2+\beta_3X^3+\epsilon
\]</span></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="co"># 加载数据</span></span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## Warning: package &#39;DAAG&#39; was built under R version 4.4.1</code></pre>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" tabindex="-1"></a><span class="co"># 初始化误差向量</span></span>
<span id="cb106-5"><a href="#cb106-5" tabindex="-1"></a>errors_model1 <span class="ot">&lt;-</span> errors_model2 <span class="ot">&lt;-</span> errors_model3 <span class="ot">&lt;-</span> errors_model4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb106-6"><a href="#cb106-6" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" tabindex="-1"></a><span class="co"># n 折交叉验证</span></span>
<span id="cb106-8"><a href="#cb106-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb106-9"><a href="#cb106-9" tabindex="-1"></a>  response <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>i]</span>
<span id="cb106-10"><a href="#cb106-10" tabindex="-1"></a>  predictor <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>i]</span>
<span id="cb106-11"><a href="#cb106-11" tabindex="-1"></a>  </span>
<span id="cb106-12"><a href="#cb106-12" tabindex="-1"></a>  <span class="co"># 模型1: 线性模型</span></span>
<span id="cb106-13"><a href="#cb106-13" tabindex="-1"></a>  model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(response <span class="sc">~</span> predictor)</span>
<span id="cb106-14"><a href="#cb106-14" tabindex="-1"></a>  pred1 <span class="ot">&lt;-</span> model1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> model1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[i]</span>
<span id="cb106-15"><a href="#cb106-15" tabindex="-1"></a>  errors_model1[i] <span class="ot">&lt;-</span> magnetic[i] <span class="sc">-</span> pred1</span>
<span id="cb106-16"><a href="#cb106-16" tabindex="-1"></a>  </span>
<span id="cb106-17"><a href="#cb106-17" tabindex="-1"></a>  <span class="co"># 模型2: 二次回归模型</span></span>
<span id="cb106-18"><a href="#cb106-18" tabindex="-1"></a>  model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(response <span class="sc">~</span> predictor <span class="sc">+</span> <span class="fu">I</span>(predictor<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb106-19"><a href="#cb106-19" tabindex="-1"></a>  pred2 <span class="ot">&lt;-</span> model2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> model2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[i] <span class="sc">+</span> model2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb106-20"><a href="#cb106-20" tabindex="-1"></a>  errors_model2[i] <span class="ot">&lt;-</span> magnetic[i] <span class="sc">-</span> pred2</span>
<span id="cb106-21"><a href="#cb106-21" tabindex="-1"></a>  </span>
<span id="cb106-22"><a href="#cb106-22" tabindex="-1"></a>  <span class="co"># 模型3: 指数模型</span></span>
<span id="cb106-23"><a href="#cb106-23" tabindex="-1"></a>  model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(response) <span class="sc">~</span> predictor)</span>
<span id="cb106-24"><a href="#cb106-24" tabindex="-1"></a>  log_pred3 <span class="ot">&lt;-</span> model3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> model3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[i]</span>
<span id="cb106-25"><a href="#cb106-25" tabindex="-1"></a>  pred3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_pred3)</span>
<span id="cb106-26"><a href="#cb106-26" tabindex="-1"></a>  errors_model3[i] <span class="ot">&lt;-</span> magnetic[i] <span class="sc">-</span> pred3</span>
<span id="cb106-27"><a href="#cb106-27" tabindex="-1"></a>  </span>
<span id="cb106-28"><a href="#cb106-28" tabindex="-1"></a>  <span class="co"># 模型4: 三次回归模型</span></span>
<span id="cb106-29"><a href="#cb106-29" tabindex="-1"></a>  model4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(response <span class="sc">~</span> predictor <span class="sc">+</span> <span class="fu">I</span>(predictor<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(predictor<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb106-30"><a href="#cb106-30" tabindex="-1"></a>  pred4 <span class="ot">&lt;-</span> model4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> model4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[i] <span class="sc">+</span> model4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> model4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> chemical[i]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb106-31"><a href="#cb106-31" tabindex="-1"></a>  errors_model4[i] <span class="ot">&lt;-</span> magnetic[i] <span class="sc">-</span> pred4</span>
<span id="cb106-32"><a href="#cb106-32" tabindex="-1"></a>}</span>
<span id="cb106-33"><a href="#cb106-33" tabindex="-1"></a></span>
<span id="cb106-34"><a href="#cb106-34" tabindex="-1"></a><span class="co"># 计算每个模型的平均平方误差</span></span>
<span id="cb106-35"><a href="#cb106-35" tabindex="-1"></a>mse_results <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(errors_model1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(errors_model2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(errors_model3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(errors_model4<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb106-36"><a href="#cb106-36" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;各模型的均方误差为:&quot;</span>, mse_results, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 各模型的均方误差为: 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="co"># 比较调整后的 R^2</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>response_var <span class="ot">&lt;-</span> magnetic</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>predictor_var <span class="ot">&lt;-</span> chemical</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a>adj_r2_values <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">lm</span>(response_var <span class="sc">~</span> predictor_var))<span class="sc">$</span>adj.r.squared,</span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">lm</span>(response_var <span class="sc">~</span> predictor_var <span class="sc">+</span> <span class="fu">I</span>(predictor_var<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">$</span>adj.r.squared,</span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">lm</span>(<span class="fu">log</span>(response_var) <span class="sc">~</span> predictor_var))<span class="sc">$</span>adj.r.squared,</span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">lm</span>(response_var <span class="sc">~</span> predictor_var <span class="sc">+</span> <span class="fu">I</span>(predictor_var<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(predictor_var<span class="sc">^</span><span class="dv">3</span>)))<span class="sc">$</span>adj.r.squared</span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a>)</span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;各模型的调整后 R^2 值为:&quot;</span>, adj_r2_values, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 各模型的调整后 R^2 值为: 0.5281545 0.5768151 0.5280556 0.5740396</code></pre>
<p>我们可以说误差平方和最小的还是二号模型，值为17.85248，而根据调整后的<span class="math inline">\(R^2\)</span>值，二号模型的值最大，所以二号模型拟合的最好。</p>
</div>
<div id="第五次第三题" class="section level2">
<h2>第五次第三题</h2>
<p>问题描述为： Implement the two-sample Cram´er-von Mises test for
equal distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="co"># 加载数据</span></span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>group1 <span class="ot">&lt;-</span> <span class="fu">sort</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>])</span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a>group2 <span class="ot">&lt;-</span> <span class="fu">sort</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])</span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb110-6"><a href="#cb110-6" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" tabindex="-1"></a><span class="co"># 定义 Cramér-von Mises 检验的统计量函数</span></span>
<span id="cb110-8"><a href="#cb110-8" tabindex="-1"></a>compute_cvm <span class="ot">&lt;-</span> <span class="cf">function</span>(group1, group2) {</span>
<span id="cb110-9"><a href="#cb110-9" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(group1)</span>
<span id="cb110-10"><a href="#cb110-10" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(group2)</span>
<span id="cb110-11"><a href="#cb110-11" tabindex="-1"></a>  combined_samples <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(group1, group2))</span>
<span id="cb110-12"><a href="#cb110-12" tabindex="-1"></a>  ecdf1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(group1)(combined_samples)</span>
<span id="cb110-13"><a href="#cb110-13" tabindex="-1"></a>  ecdf2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(group2)(combined_samples)</span>
<span id="cb110-14"><a href="#cb110-14" tabindex="-1"></a>  </span>
<span id="cb110-15"><a href="#cb110-15" tabindex="-1"></a>  <span class="co"># 计算统计量</span></span>
<span id="cb110-16"><a href="#cb110-16" tabindex="-1"></a>  statistic <span class="ot">&lt;-</span> (n1 <span class="sc">*</span> n2 <span class="sc">/</span> (n1 <span class="sc">+</span> n2)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sum</span>((ecdf1 <span class="sc">-</span> ecdf2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb110-17"><a href="#cb110-17" tabindex="-1"></a>  <span class="fu">return</span>(statistic)</span>
<span id="cb110-18"><a href="#cb110-18" tabindex="-1"></a>}</span>
<span id="cb110-19"><a href="#cb110-19" tabindex="-1"></a></span>
<span id="cb110-20"><a href="#cb110-20" tabindex="-1"></a><span class="co"># 计算原始数据的统计量</span></span>
<span id="cb110-21"><a href="#cb110-21" tabindex="-1"></a>observed_stat <span class="ot">&lt;-</span> <span class="fu">compute_cvm</span>(group1, group2)</span>
<span id="cb110-22"><a href="#cb110-22" tabindex="-1"></a></span>
<span id="cb110-23"><a href="#cb110-23" tabindex="-1"></a><span class="co"># 置换检验的设置</span></span>
<span id="cb110-24"><a href="#cb110-24" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 保证结果可重复</span></span>
<span id="cb110-25"><a href="#cb110-25" tabindex="-1"></a>num_permutations <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb110-26"><a href="#cb110-26" tabindex="-1"></a>perm_stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_permutations)</span>
<span id="cb110-27"><a href="#cb110-27" tabindex="-1"></a></span>
<span id="cb110-28"><a href="#cb110-28" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_permutations) {</span>
<span id="cb110-29"><a href="#cb110-29" tabindex="-1"></a>  shuffled_data <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(group1, group2))</span>
<span id="cb110-30"><a href="#cb110-30" tabindex="-1"></a>  perm_group1 <span class="ot">&lt;-</span> shuffled_data[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(group1)]</span>
<span id="cb110-31"><a href="#cb110-31" tabindex="-1"></a>  perm_group2 <span class="ot">&lt;-</span> shuffled_data[(<span class="fu">length</span>(group1) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(shuffled_data)]</span>
<span id="cb110-32"><a href="#cb110-32" tabindex="-1"></a>  perm_stats[j] <span class="ot">&lt;-</span> <span class="fu">compute_cvm</span>(perm_group1, perm_group2)</span>
<span id="cb110-33"><a href="#cb110-33" tabindex="-1"></a>}</span>
<span id="cb110-34"><a href="#cb110-34" tabindex="-1"></a></span>
<span id="cb110-35"><a href="#cb110-35" tabindex="-1"></a><span class="co"># 计算 p 值</span></span>
<span id="cb110-36"><a href="#cb110-36" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(observed_stat, perm_stats) <span class="sc">&gt;=</span> observed_stat)</span>
<span id="cb110-37"><a href="#cb110-37" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Cramér-von Mises 置换检验的 p 值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Cramér-von Mises 置换检验的 p 值: 0.4225774</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="co"># 绘制置换分布的直方图</span></span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a><span class="fu">hist</span>(perm_stats, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">&quot;scott&quot;</span>)</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a><span class="fu">points</span>(observed_stat, <span class="dv">0</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>)  <span class="co"># 标出观测到的统计量</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- -->
得到的p值是0.4225774，不拒绝原假设，喂不同饲料的鸡的体重分布可能没有区别。</p>
</div>
<div id="第五次第四题" class="section level2">
<h2>第五次第四题</h2>
<p>问题描述为：Implement the bivariate Spearman rank correlation test
for independence [255] as a permutation test. The Spearman rank
correlation test statistic can be obtained from function cor with method
= “spearman”. Compare the achieved significance level of the permutation
test with the p-value reported by cor.test on the same samples.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a><span class="co"># 使用 cor 函数计算 Spearman 秩相关系数</span></span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a>observed_stat <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a><span class="co"># 设置置换检验参数</span></span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a>num_permutations <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a>perm_stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_permutations)</span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a></span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a><span class="co"># 置换检验</span></span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_permutations) {</span>
<span id="cb113-14"><a href="#cb113-14" tabindex="-1"></a>  perm_y <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)  </span>
<span id="cb113-15"><a href="#cb113-15" tabindex="-1"></a>  perm_stats[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, perm_y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb113-16"><a href="#cb113-16" tabindex="-1"></a>}</span>
<span id="cb113-17"><a href="#cb113-17" tabindex="-1"></a></span>
<span id="cb113-18"><a href="#cb113-18" tabindex="-1"></a><span class="co"># 计算置换检验的 p 值</span></span>
<span id="cb113-19"><a href="#cb113-19" tabindex="-1"></a>p_value_perm <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(perm_stats) <span class="sc">&gt;=</span> <span class="fu">abs</span>(observed_stat))</span>
<span id="cb113-20"><a href="#cb113-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;置换检验的 p 值:&quot;</span>, p_value_perm, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 置换检验的 p 值: 0.337</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="co"># 使用 cor.test 函数计算 Spearman 检验的 p 值</span></span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a>test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;cor.test 的 p 值:&quot;</span>, test_result<span class="sc">$</span>p.value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## cor.test 的 p 值: 0.3482088</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="co"># 绘制置换检验统计量的直方图</span></span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a><span class="fu">hist</span>(perm_stats, <span class="at">main =</span> <span class="st">&quot;置换检验统计量分布&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">&quot;scott&quot;</span>)</span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> observed_stat, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="第六次作业" class="section level1">
<h1>第六次作业</h1>
<div id="第六次第一题" class="section level2">
<h2>第六次第一题</h2>
<p>问题描述为：Use the Metropolis-Hastings sampler to generate random
variables from a standard Cauchy distribution. Discard the first 1000 of
the chain, and compare the deciles of the generated observations with
the deciles of the standard Cauchy distribution (see qcauchy or qt with
<span class="math inline">\(\mathrm{df}=1\)</span> ). Recall that a
<span class="math inline">\(\operatorname{Cauchy}(\theta, \eta)\)</span>
distribution has density function <span class="math display">\[
f(x)=\frac{1}{\theta \pi\left(1+[(x-\eta) / \theta]^2\right)},
\quad-\infty&lt;x&lt;\infty, \theta&gt;0 .
\]</span></p>
<p>The standard Cauchy has the <span class="math inline">\(\operatorname{Cauchy}(\theta=1, \eta=0)\)</span>
density. (Note that the standard Cauchy density is equal to the Student
<span class="math inline">\(t\)</span> density with one degree of
freedom.)</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 生成样本数</span></span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># 丢弃的前1000个样本</span></span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)  <span class="co"># 存储生成的样本</span></span>
<span id="cb118-6"><a href="#cb118-6" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># 初始值</span></span>
<span id="cb118-7"><a href="#cb118-7" tabindex="-1"></a></span>
<span id="cb118-8"><a href="#cb118-8" tabindex="-1"></a><span class="co"># Metropolis-Hastings 采样</span></span>
<span id="cb118-9"><a href="#cb118-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb118-10"><a href="#cb118-10" tabindex="-1"></a>  <span class="co"># 使用正态分布作为提议分布</span></span>
<span id="cb118-11"><a href="#cb118-11" tabindex="-1"></a>  proposal <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb118-12"><a href="#cb118-12" tabindex="-1"></a>  </span>
<span id="cb118-13"><a href="#cb118-13" tabindex="-1"></a>  <span class="co"># 计算接受率</span></span>
<span id="cb118-14"><a href="#cb118-14" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(proposal, <span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">dcauchy</span>(x[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb118-15"><a href="#cb118-15" tabindex="-1"></a>  </span>
<span id="cb118-16"><a href="#cb118-16" tabindex="-1"></a>  <span class="co"># 接受或拒绝</span></span>
<span id="cb118-17"><a href="#cb118-17" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> alpha) {</span>
<span id="cb118-18"><a href="#cb118-18" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> proposal</span>
<span id="cb118-19"><a href="#cb118-19" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb118-20"><a href="#cb118-20" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb118-21"><a href="#cb118-21" tabindex="-1"></a>  }</span>
<span id="cb118-22"><a href="#cb118-22" tabindex="-1"></a>}</span>
<span id="cb118-23"><a href="#cb118-23" tabindex="-1"></a></span>
<span id="cb118-24"><a href="#cb118-24" tabindex="-1"></a><span class="co"># 丢弃前1000个样本</span></span>
<span id="cb118-25"><a href="#cb118-25" tabindex="-1"></a>samples <span class="ot">&lt;-</span> x[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n]</span>
<span id="cb118-26"><a href="#cb118-26" tabindex="-1"></a></span>
<span id="cb118-27"><a href="#cb118-27" tabindex="-1"></a><span class="co"># 计算生成样本的分位数</span></span>
<span id="cb118-28"><a href="#cb118-28" tabindex="-1"></a>sample_deciles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb118-29"><a href="#cb118-29" tabindex="-1"></a></span>
<span id="cb118-30"><a href="#cb118-30" tabindex="-1"></a><span class="co"># 计算标准柯西分布的分位数</span></span>
<span id="cb118-31"><a href="#cb118-31" tabindex="-1"></a>true_deciles <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb118-32"><a href="#cb118-32" tabindex="-1"></a></span>
<span id="cb118-33"><a href="#cb118-33" tabindex="-1"></a><span class="co"># 对比结果</span></span>
<span id="cb118-34"><a href="#cb118-34" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample_Deciles =</span> sample_deciles, <span class="at">True_Deciles =</span> true_deciles)</span>
<span id="cb118-35"><a href="#cb118-35" tabindex="-1"></a></span>
<span id="cb118-36"><a href="#cb118-36" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##     Sample_Deciles True_Deciles
## 10%    -2.81748908   -3.0776835
## 20%    -1.40266892   -1.3763819
## 30%    -0.73784530   -0.7265425
## 40%    -0.33350883   -0.3249197
## 50%    -0.01642563    0.0000000
## 60%     0.30706020    0.3249197
## 70%     0.72330174    0.7265425
## 80%     1.37266697    1.3763819
## 90%     3.02836810    3.0776835</code></pre>
<p>可以看出，结果还不错</p>
</div>
<div id="第六次第二题" class="section level2">
<h2>第六次第二题</h2>
<p>问题描述为：This example appears in [40]. Consider the bivariate
density <span class="math display">\[
f(x, y) \propto\binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1,
\ldots, n, 0 \leq y \leq 1
\]</span></p>
<p>It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions
are <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span>
and <span class="math inline">\(\operatorname{Beta}(x+a,
n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target
joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>      <span class="co"># 二项分布的样本数量</span></span>
<span id="cb120-4"><a href="#cb120-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>       <span class="co"># Beta 分布的参数 a</span></span>
<span id="cb120-5"><a href="#cb120-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span>       <span class="co"># Beta 分布的参数 b</span></span>
<span id="cb120-6"><a href="#cb120-6" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Gibbs 采样的总迭代次数</span></span>
<span id="cb120-7"><a href="#cb120-7" tabindex="-1"></a></span>
<span id="cb120-8"><a href="#cb120-8" tabindex="-1"></a><span class="co"># 初始化向量</span></span>
<span id="cb120-9"><a href="#cb120-9" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb120-10"><a href="#cb120-10" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb120-11"><a href="#cb120-11" tabindex="-1"></a>y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># 给定初始值</span></span>
<span id="cb120-12"><a href="#cb120-12" tabindex="-1"></a></span>
<span id="cb120-13"><a href="#cb120-13" tabindex="-1"></a><span class="co"># Gibbs 采样过程</span></span>
<span id="cb120-14"><a href="#cb120-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>iterations) {</span>
<span id="cb120-15"><a href="#cb120-15" tabindex="-1"></a>  <span class="co"># 给定 y[i - 1] 采样</span></span>
<span id="cb120-16"><a href="#cb120-16" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb120-17"><a href="#cb120-17" tabindex="-1"></a>  </span>
<span id="cb120-18"><a href="#cb120-18" tabindex="-1"></a>  <span class="co"># 给定 x[i] 采样</span></span>
<span id="cb120-19"><a href="#cb120-19" tabindex="-1"></a>  y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[i] <span class="sc">+</span> a, n <span class="sc">-</span> x[i] <span class="sc">+</span> b)</span>
<span id="cb120-20"><a href="#cb120-20" tabindex="-1"></a>}</span>
<span id="cb120-21"><a href="#cb120-21" tabindex="-1"></a></span>
<span id="cb120-22"><a href="#cb120-22" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb120-23"><a href="#cb120-23" tabindex="-1"></a>x_samples <span class="ot">&lt;-</span> x[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iterations]</span>
<span id="cb120-24"><a href="#cb120-24" tabindex="-1"></a>y_samples <span class="ot">&lt;-</span> y[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iterations]</span>
<span id="cb120-25"><a href="#cb120-25" tabindex="-1"></a></span>
<span id="cb120-26"><a href="#cb120-26" tabindex="-1"></a><span class="co"># 绘图：展示采样结果</span></span>
<span id="cb120-27"><a href="#cb120-27" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb120-28"><a href="#cb120-28" tabindex="-1"></a><span class="fu">plot</span>(x_samples, y_samples, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb120-29"><a href="#cb120-29" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Gibbs 采样生成的 (x, y) 样本点&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb120-30"><a href="#cb120-30" tabindex="-1"></a><span class="fu">hist</span>(y_samples, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, </span>
<span id="cb120-31"><a href="#cb120-31" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;y 的边际分布&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="第六次第三题" class="section level2">
<h2>第六次第三题</h2>
<p>问题描述为：For each of the above exercise, use the Gelman-Rubin
method to monitor convergence of the chain, and run the chain until it
converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<p>第一题代码的Gelman-Rubin统计量，运行三条链</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb121-5"><a href="#cb121-5" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb121-6"><a href="#cb121-6" tabindex="-1"></a>samples_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb121-7"><a href="#cb121-7" tabindex="-1"></a></span>
<span id="cb121-8"><a href="#cb121-8" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>chains) {</span>
<span id="cb121-9"><a href="#cb121-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb121-10"><a href="#cb121-10" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb121-11"><a href="#cb121-11" tabindex="-1"></a>  </span>
<span id="cb121-12"><a href="#cb121-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb121-13"><a href="#cb121-13" tabindex="-1"></a>    proposal <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb121-14"><a href="#cb121-14" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(proposal, <span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">dcauchy</span>(x[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb121-15"><a href="#cb121-15" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> alpha) {</span>
<span id="cb121-16"><a href="#cb121-16" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> proposal</span>
<span id="cb121-17"><a href="#cb121-17" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb121-18"><a href="#cb121-18" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb121-19"><a href="#cb121-19" tabindex="-1"></a>    }</span>
<span id="cb121-20"><a href="#cb121-20" tabindex="-1"></a>  }</span>
<span id="cb121-21"><a href="#cb121-21" tabindex="-1"></a>  </span>
<span id="cb121-22"><a href="#cb121-22" tabindex="-1"></a>  samples_list[[j]] <span class="ot">&lt;-</span> x[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n]</span>
<span id="cb121-23"><a href="#cb121-23" tabindex="-1"></a>}</span>
<span id="cb121-24"><a href="#cb121-24" tabindex="-1"></a></span>
<span id="cb121-25"><a href="#cb121-25" tabindex="-1"></a><span class="co"># Gelman-Rubin 手动计算</span></span>
<span id="cb121-26"><a href="#cb121-26" tabindex="-1"></a>m <span class="ot">&lt;-</span> chains</span>
<span id="cb121-27"><a href="#cb121-27" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> n <span class="sc">-</span> burn_in</span>
<span id="cb121-28"><a href="#cb121-28" tabindex="-1"></a>chain_means <span class="ot">&lt;-</span> <span class="fu">sapply</span>(samples_list, mean)</span>
<span id="cb121-29"><a href="#cb121-29" tabindex="-1"></a>overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(chain_means)</span>
<span id="cb121-30"><a href="#cb121-30" tabindex="-1"></a>chain_vars <span class="ot">&lt;-</span> <span class="fu">sapply</span>(samples_list, var)</span>
<span id="cb121-31"><a href="#cb121-31" tabindex="-1"></a></span>
<span id="cb121-32"><a href="#cb121-32" tabindex="-1"></a><span class="co"># 计算链内方差 W</span></span>
<span id="cb121-33"><a href="#cb121-33" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">mean</span>(chain_vars)</span>
<span id="cb121-34"><a href="#cb121-34" tabindex="-1"></a></span>
<span id="cb121-35"><a href="#cb121-35" tabindex="-1"></a><span class="co"># 计算链间方差 B</span></span>
<span id="cb121-36"><a href="#cb121-36" tabindex="-1"></a>B <span class="ot">&lt;-</span> n_samples <span class="sc">*</span> <span class="fu">var</span>(chain_means)</span>
<span id="cb121-37"><a href="#cb121-37" tabindex="-1"></a></span>
<span id="cb121-38"><a href="#cb121-38" tabindex="-1"></a><span class="co"># 计算总方差估计 V</span></span>
<span id="cb121-39"><a href="#cb121-39" tabindex="-1"></a>V <span class="ot">&lt;-</span> ((n_samples <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n_samples) <span class="sc">*</span> W <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> n_samples) <span class="sc">*</span> B</span>
<span id="cb121-40"><a href="#cb121-40" tabindex="-1"></a></span>
<span id="cb121-41"><a href="#cb121-41" tabindex="-1"></a><span class="co"># 计算 Gelman-Rubin 统计量</span></span>
<span id="cb121-42"><a href="#cb121-42" tabindex="-1"></a>R_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(V <span class="sc">/</span> W)</span>
<span id="cb121-43"><a href="#cb121-43" tabindex="-1"></a></span>
<span id="cb121-44"><a href="#cb121-44" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Gelman-Rubin 统计量 (R_hat) 为:&quot;</span>, R_hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Gelman-Rubin 统计量 (R_hat) 为: 1.014286</code></pre>
<p>第二题的Gelman-Rubin统计量，运行三条链</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb123-5"><a href="#cb123-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb123-6"><a href="#cb123-6" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb123-7"><a href="#cb123-7" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb123-8"><a href="#cb123-8" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb123-9"><a href="#cb123-9" tabindex="-1"></a>y_initial <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb123-10"><a href="#cb123-10" tabindex="-1"></a>samples_list_x <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb123-11"><a href="#cb123-11" tabindex="-1"></a>samples_list_y <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb123-12"><a href="#cb123-12" tabindex="-1"></a></span>
<span id="cb123-13"><a href="#cb123-13" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>chains) {</span>
<span id="cb123-14"><a href="#cb123-14" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb123-15"><a href="#cb123-15" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb123-16"><a href="#cb123-16" tabindex="-1"></a>  y[<span class="dv">1</span>] <span class="ot">&lt;-</span> y_initial</span>
<span id="cb123-17"><a href="#cb123-17" tabindex="-1"></a>  </span>
<span id="cb123-18"><a href="#cb123-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>iterations) {</span>
<span id="cb123-19"><a href="#cb123-19" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb123-20"><a href="#cb123-20" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[i] <span class="sc">+</span> a, n <span class="sc">-</span> x[i] <span class="sc">+</span> b)</span>
<span id="cb123-21"><a href="#cb123-21" tabindex="-1"></a>  }</span>
<span id="cb123-22"><a href="#cb123-22" tabindex="-1"></a>  </span>
<span id="cb123-23"><a href="#cb123-23" tabindex="-1"></a>  samples_list_x[[j]] <span class="ot">&lt;-</span> x[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iterations]</span>
<span id="cb123-24"><a href="#cb123-24" tabindex="-1"></a>  samples_list_y[[j]] <span class="ot">&lt;-</span> y[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iterations]</span>
<span id="cb123-25"><a href="#cb123-25" tabindex="-1"></a>}</span>
<span id="cb123-26"><a href="#cb123-26" tabindex="-1"></a></span>
<span id="cb123-27"><a href="#cb123-27" tabindex="-1"></a><span class="co"># Gelman-Rubin 手动计算 X 的 R_hat</span></span>
<span id="cb123-28"><a href="#cb123-28" tabindex="-1"></a>chain_means_x <span class="ot">&lt;-</span> <span class="fu">sapply</span>(samples_list_x, mean)</span>
<span id="cb123-29"><a href="#cb123-29" tabindex="-1"></a>overall_mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(chain_means_x)</span>
<span id="cb123-30"><a href="#cb123-30" tabindex="-1"></a>chain_vars_x <span class="ot">&lt;-</span> <span class="fu">sapply</span>(samples_list_x, var)</span>
<span id="cb123-31"><a href="#cb123-31" tabindex="-1"></a>W_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(chain_vars_x)</span>
<span id="cb123-32"><a href="#cb123-32" tabindex="-1"></a>B_x <span class="ot">&lt;-</span> n_samples <span class="sc">*</span> <span class="fu">var</span>(chain_means_x)</span>
<span id="cb123-33"><a href="#cb123-33" tabindex="-1"></a>V_x <span class="ot">&lt;-</span> ((n_samples <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n_samples) <span class="sc">*</span> W_x <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> n_samples) <span class="sc">*</span> B_x</span>
<span id="cb123-34"><a href="#cb123-34" tabindex="-1"></a>R_hat_x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(V_x <span class="sc">/</span> W_x)</span>
<span id="cb123-35"><a href="#cb123-35" tabindex="-1"></a></span>
<span id="cb123-36"><a href="#cb123-36" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Gelman-Rubin 统计量 X (R_hat) 为:&quot;</span>, R_hat_x, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Gelman-Rubin 统计量 X (R_hat) 为: 0.9999908</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="co"># Gelman-Rubin 手动计算 Y 的 R_hat</span></span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>chain_means_y <span class="ot">&lt;-</span> <span class="fu">sapply</span>(samples_list_y, mean)</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a>overall_mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(chain_means_y)</span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a>chain_vars_y <span class="ot">&lt;-</span> <span class="fu">sapply</span>(samples_list_y, var)</span>
<span id="cb125-5"><a href="#cb125-5" tabindex="-1"></a>W_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(chain_vars_y)</span>
<span id="cb125-6"><a href="#cb125-6" tabindex="-1"></a>B_y <span class="ot">&lt;-</span> n_samples <span class="sc">*</span> <span class="fu">var</span>(chain_means_y)</span>
<span id="cb125-7"><a href="#cb125-7" tabindex="-1"></a>V_y <span class="ot">&lt;-</span> ((n_samples <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n_samples) <span class="sc">*</span> W_y <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> n_samples) <span class="sc">*</span> B_y</span>
<span id="cb125-8"><a href="#cb125-8" tabindex="-1"></a>R_hat_y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(V_y <span class="sc">/</span> W_y)</span>
<span id="cb125-9"><a href="#cb125-9" tabindex="-1"></a></span>
<span id="cb125-10"><a href="#cb125-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Gelman-Rubin 统计量 Y (R_hat) 为:&quot;</span>, R_hat_y, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Gelman-Rubin 统计量 Y (R_hat) 为: 0.9999714</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">log</span>(x<span class="sc">+</span><span class="fu">log</span>(x))<span class="sc">/</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x)</span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a><span class="fu">curve</span>(f,<span class="dv">3</span>,<span class="dv">10</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">optimize</span>(f,<span class="at">lower=</span><span class="dv">4</span>,<span class="at">upper=</span><span class="dv">8</span>,<span class="at">maximum=</span><span class="cn">FALSE</span>)</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>## $minimum
## [1] 7.99994
## 
## $objective
## [1] 1.051553</code></pre>
</div>
</div>
<div id="第七次作业" class="section level1">
<h1>第七次作业</h1>
<div id="第七次第一题" class="section level2">
<h2>第七次第一题</h2>
<p>问题描述为：(a) Write a function to compute the <span class="math inline">\(k^{t h}\)</span> term in <span class="math display">\[
\sum_{k=0}^{\infty} \frac{(-1)^k}{k!2^k} \frac{\|a\|^{2 k+2}}{(2 k+1)(2
k+2)} \frac{\Gamma\left(\frac{d+1}{2}\right)
\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)}
\]</span> where <span class="math inline">\(d \geq 1\)</span> is an
integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^d\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm.
Perform the arithmetic so that the coefficients can be computed for
(almost) arbitrarily large <span class="math inline">\(k\)</span> and
<span class="math inline">\(d\)</span>. (This sum converges for all
<span class="math inline">\(a \in \mathbb{R}^d\)</span> ). (b) Modify
the function so that it computes and returns the sum. (c) Evaluate the
sum when <span class="math inline">\(a=(1,2)^T\)</span>.</p>
<p>(a)我们首先构造计算第k项的函数，使得对于几乎任意的k和d都能计算</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>compute_kth_term <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a) {</span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a>  <span class="co"># 计算 Euclidean 范数</span></span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb130-5"><a href="#cb130-5" tabindex="-1"></a>  </span>
<span id="cb130-6"><a href="#cb130-6" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.double</span>(k)<span class="sc">==</span><span class="cn">TRUE</span>){</span>
<span id="cb130-7"><a href="#cb130-7" tabindex="-1"></a>  <span class="co">#为了防止k过大导致gamma函数值和幂值过大，先取log</span></span>
<span id="cb130-8"><a href="#cb130-8" tabindex="-1"></a>  log_gamma_part <span class="ot">&lt;-</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb130-9"><a href="#cb130-9" tabindex="-1"></a>  log_norm_part <span class="ot">&lt;-</span> k<span class="sc">*</span><span class="fu">log</span>(norm_a<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb130-10"><a href="#cb130-10" tabindex="-1"></a>  <span class="co"># 返回第 k 项</span></span>
<span id="cb130-11"><a href="#cb130-11" tabindex="-1"></a>  <span class="fu">return</span>((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">*</span>(norm_a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span> <span class="fu">exp</span>(log_norm_part<span class="sc">+</span>log_gamma_part<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)))}</span>
<span id="cb130-12"><a href="#cb130-12" tabindex="-1"></a>  <span class="cf">else</span> {<span class="fu">return</span>(<span class="st">&quot;error&quot;</span>)}</span>
<span id="cb130-13"><a href="#cb130-13" tabindex="-1"></a>}</span>
<span id="cb130-14"><a href="#cb130-14" tabindex="-1"></a><span class="fu">compute_kth_term</span>(<span class="dv">1000</span>,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>(b)下面构造求和函数</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a>compute_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(a, <span class="at">tol =</span> <span class="fl">1e-20</span>, <span class="at">max_iter =</span> <span class="dv">1000</span>) {</span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a>  sum_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a>  </span>
<span id="cb132-6"><a href="#cb132-6" tabindex="-1"></a>  <span class="cf">repeat</span> {</span>
<span id="cb132-7"><a href="#cb132-7" tabindex="-1"></a>    term <span class="ot">&lt;-</span> <span class="fu">compute_kth_term</span>(k, a)</span>
<span id="cb132-8"><a href="#cb132-8" tabindex="-1"></a>    sum_value <span class="ot">&lt;-</span> sum_value <span class="sc">+</span> term</span>
<span id="cb132-9"><a href="#cb132-9" tabindex="-1"></a>    </span>
<span id="cb132-10"><a href="#cb132-10" tabindex="-1"></a>    <span class="co"># 检查是否满足收敛条件</span></span>
<span id="cb132-11"><a href="#cb132-11" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(term) <span class="sc">&lt;</span> tol <span class="sc">||</span> k <span class="sc">&gt;=</span> max_iter) <span class="cf">break</span></span>
<span id="cb132-12"><a href="#cb132-12" tabindex="-1"></a>    </span>
<span id="cb132-13"><a href="#cb132-13" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb132-14"><a href="#cb132-14" tabindex="-1"></a>  }</span>
<span id="cb132-15"><a href="#cb132-15" tabindex="-1"></a>  </span>
<span id="cb132-16"><a href="#cb132-16" tabindex="-1"></a>  <span class="fu">return</span>(sum_value)</span>
<span id="cb132-17"><a href="#cb132-17" tabindex="-1"></a>}</span></code></pre></div>
<p>(3)最后计算<span class="math inline">\(a=(1,2)^T\)</span>时的值</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="fu">compute_sum</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
</div>
<div id="第七次第二题" class="section level2">
<h2>第七次第二题</h2>
<p>问题描述为：Write a function to solve the equation <span class="math display">\[
\begin{aligned}
&amp; \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)
\Gamma\left(\frac{k-1}{2}\right)}}
\int_0^{c_{k-1}}\left(1+\frac{u^2}{k-1}\right)^{-k / 2} d u \\
&amp; \quad=\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k}
\Gamma\left(\frac{k}{2}\right)}
\int_0^{c_k}\left(1+\frac{u^2}{k}\right)^{-(k+1) / 2} d u
\end{aligned}
\]</span> for <span class="math inline">\(a\)</span>, where <span class="math display">\[
c_k=\sqrt{\frac{a^2 k}{k+1-a^2}} .
\]</span></p>
<p>Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<p>我们构造如下的函数用来计算使等式成立的a</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="co"># 定义 c_k 函数</span></span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a>c_k <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb135-3"><a href="#cb135-3" tabindex="-1"></a>  <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb135-4"><a href="#cb135-4" tabindex="-1"></a>}</span>
<span id="cb135-5"><a href="#cb135-5" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" tabindex="-1"></a><span class="co"># 定义方程左边的积分和表达式</span></span>
<span id="cb135-7"><a href="#cb135-7" tabindex="-1"></a>lhs <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb135-8"><a href="#cb135-8" tabindex="-1"></a>  ck_minus_1 <span class="ot">&lt;-</span> <span class="fu">c_k</span>(a, k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb135-9"><a href="#cb135-9" tabindex="-1"></a>  integrand_lhs <span class="ot">&lt;-</span> <span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>k <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb135-10"><a href="#cb135-10" tabindex="-1"></a>  </span>
<span id="cb135-11"><a href="#cb135-11" tabindex="-1"></a>  integral_lhs <span class="ot">&lt;-</span> <span class="fu">integrate</span>(integrand_lhs, <span class="dv">0</span>, ck_minus_1)<span class="sc">$</span>value</span>
<span id="cb135-12"><a href="#cb135-12" tabindex="-1"></a>  </span>
<span id="cb135-13"><a href="#cb135-13" tabindex="-1"></a>  <span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>(k <span class="sc">/</span> <span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">sqrt</span>(pi <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>))  <span class="sc">*</span> integral_lhs</span>
<span id="cb135-14"><a href="#cb135-14" tabindex="-1"></a>}</span>
<span id="cb135-15"><a href="#cb135-15" tabindex="-1"></a></span>
<span id="cb135-16"><a href="#cb135-16" tabindex="-1"></a><span class="co"># 定义方程右边的积分和表达式</span></span>
<span id="cb135-17"><a href="#cb135-17" tabindex="-1"></a>rhs <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb135-18"><a href="#cb135-18" tabindex="-1"></a>  ck <span class="ot">&lt;-</span> <span class="fu">c_k</span>(a, k)</span>
<span id="cb135-19"><a href="#cb135-19" tabindex="-1"></a>  integrand_rhs <span class="ot">&lt;-</span> <span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb135-20"><a href="#cb135-20" tabindex="-1"></a>  </span>
<span id="cb135-21"><a href="#cb135-21" tabindex="-1"></a>  integral_rhs <span class="ot">&lt;-</span> <span class="fu">integrate</span>(integrand_rhs, <span class="dv">0</span>, ck)<span class="sc">$</span>value</span>
<span id="cb135-22"><a href="#cb135-22" tabindex="-1"></a>  <span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">sqrt</span>(pi <span class="sc">*</span> k) <span class="sc">*</span> integral_rhs</span>
<span id="cb135-23"><a href="#cb135-23" tabindex="-1"></a>}</span>
<span id="cb135-24"><a href="#cb135-24" tabindex="-1"></a></span>
<span id="cb135-25"><a href="#cb135-25" tabindex="-1"></a><span class="co"># 定义方程的差值（左右两边差）</span></span>
<span id="cb135-26"><a href="#cb135-26" tabindex="-1"></a>equation <span class="ot">&lt;-</span> <span class="cf">function</span>(a, <span class="at">k=</span><span class="dv">100</span>) {</span>
<span id="cb135-27"><a href="#cb135-27" tabindex="-1"></a>  <span class="fu">lhs</span>(a, k) <span class="sc">-</span> <span class="fu">rhs</span>(a, k)</span>
<span id="cb135-28"><a href="#cb135-28" tabindex="-1"></a>}</span>
<span id="cb135-29"><a href="#cb135-29" tabindex="-1"></a></span>
<span id="cb135-30"><a href="#cb135-30" tabindex="-1"></a><span class="co"># 给定 k 值求解 a</span></span>
<span id="cb135-31"><a href="#cb135-31" tabindex="-1"></a>solve_for_a <span class="ot">&lt;-</span> <span class="cf">function</span>(k, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fu">min</span>(<span class="dv">3</span>,<span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">1e-5</span>))) {</span>
<span id="cb135-32"><a href="#cb135-32" tabindex="-1"></a>  <span class="fu">uniroot</span>(equation, <span class="at">interval =</span> interval, <span class="at">k =</span> k)<span class="sc">$</span>root</span>
<span id="cb135-33"><a href="#cb135-33" tabindex="-1"></a>}</span>
<span id="cb135-34"><a href="#cb135-34" tabindex="-1"></a></span>
<span id="cb135-35"><a href="#cb135-35" tabindex="-1"></a><span class="co"># 示例：在不同的 k 值下求解 a 并输出结果</span></span>
<span id="cb135-36"><a href="#cb135-36" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)  <span class="co"># 可以根据需要更改 k 的范围</span></span>
<span id="cb135-37"><a href="#cb135-37" tabindex="-1"></a>solutions <span class="ot">&lt;-</span> <span class="fu">sapply</span>(k_values, solve_for_a)</span>
<span id="cb135-38"><a href="#cb135-38" tabindex="-1"></a></span>
<span id="cb135-39"><a href="#cb135-39" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb135-40"><a href="#cb135-40" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(k_values)) {</span>
<span id="cb135-41"><a href="#cb135-41" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;当 k =&quot;</span>, k_values[i], <span class="st">&quot;时，a 的解为:&quot;</span>, solutions[i], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb135-42"><a href="#cb135-42" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 当 k = 4 时，a 的解为: 1.492105 
## 当 k = 5 时，a 的解为: 1.533559 
## 当 k = 6 时，a 的解为: 1.562746 
## 当 k = 7 时，a 的解为: 1.584429 
## 当 k = 8 时，a 的解为: 1.601168 
## 当 k = 9 时，a 的解为: 1.614497 
## 当 k = 10 时，a 的解为: 1.625362 
## 当 k = 11 时，a 的解为: 1.634409 
## 当 k = 12 时，a 的解为: 1.642026 
## 当 k = 13 时，a 的解为: 1.648538 
## 当 k = 14 时，a 的解为: 1.65417 
## 当 k = 15 时，a 的解为: 1.659109 
## 当 k = 16 时，a 的解为: 1.663443 
## 当 k = 17 时，a 的解为: 1.667291 
## 当 k = 18 时，a 的解为: 1.67073 
## 当 k = 19 时，a 的解为: 1.673822 
## 当 k = 20 时，a 的解为: 1.676601 
## 当 k = 21 时，a 的解为: 1.679125 
## 当 k = 22 时，a 的解为: 1.681493 
## 当 k = 23 时，a 的解为: 1.68361 
## 当 k = 24 时，a 的解为: 1.685558 
## 当 k = 25 时，a 的解为: 1.687356 
## 当 k = 100 时，a 的解为: 1.720599 
## 当 k = 500 时，a 的解为: 1.729728 
## 当 k = 1000 时，a 的解为: 1.730877</code></pre>
<p>下面是11.4中的A(k)</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a><span class="co"># 定义 S_{k-1}(a) 函数</span></span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a>S_k_minus_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a>  threshold <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (k <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb137-4"><a href="#cb137-4" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(threshold, <span class="at">df =</span> k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb137-5"><a href="#cb137-5" tabindex="-1"></a>}</span>
<span id="cb137-6"><a href="#cb137-6" tabindex="-1"></a></span>
<span id="cb137-7"><a href="#cb137-7" tabindex="-1"></a><span class="co"># 定义 S_k(a) 函数</span></span>
<span id="cb137-8"><a href="#cb137-8" tabindex="-1"></a>S_k <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb137-9"><a href="#cb137-9" tabindex="-1"></a>  threshold <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb137-10"><a href="#cb137-10" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(threshold, <span class="at">df =</span> k)</span>
<span id="cb137-11"><a href="#cb137-11" tabindex="-1"></a>}</span>
<span id="cb137-12"><a href="#cb137-12" tabindex="-1"></a></span>
<span id="cb137-13"><a href="#cb137-13" tabindex="-1"></a><span class="co"># 定义交点方程的差值</span></span>
<span id="cb137-14"><a href="#cb137-14" tabindex="-1"></a>equation <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb137-15"><a href="#cb137-15" tabindex="-1"></a>  <span class="fu">S_k_minus_1</span>(a, k) <span class="sc">-</span> <span class="fu">S_k</span>(a, k)</span>
<span id="cb137-16"><a href="#cb137-16" tabindex="-1"></a>}</span>
<span id="cb137-17"><a href="#cb137-17" tabindex="-1"></a></span>
<span id="cb137-18"><a href="#cb137-18" tabindex="-1"></a><span class="co"># 求解 a 使得 S_{k-1}(a) = S_k(a)</span></span>
<span id="cb137-19"><a href="#cb137-19" tabindex="-1"></a>solve_for_Ak <span class="ot">&lt;-</span> <span class="cf">function</span>(k, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fu">min</span>(<span class="dv">3</span>,<span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">1e-5</span>))) {</span>
<span id="cb137-20"><a href="#cb137-20" tabindex="-1"></a>  <span class="fu">uniroot</span>(equation, <span class="at">interval =</span> interval, <span class="at">k =</span> k)<span class="sc">$</span>root</span>
<span id="cb137-21"><a href="#cb137-21" tabindex="-1"></a>}</span>
<span id="cb137-22"><a href="#cb137-22" tabindex="-1"></a></span>
<span id="cb137-23"><a href="#cb137-23" tabindex="-1"></a><span class="co"># 在不同的 k 值下找到交点 A(k)</span></span>
<span id="cb137-24"><a href="#cb137-24" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb137-25"><a href="#cb137-25" tabindex="-1"></a>solutions <span class="ot">&lt;-</span> <span class="fu">sapply</span>(k_values, solve_for_Ak)</span>
<span id="cb137-26"><a href="#cb137-26" tabindex="-1"></a></span>
<span id="cb137-27"><a href="#cb137-27" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb137-28"><a href="#cb137-28" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(k_values)) {</span>
<span id="cb137-29"><a href="#cb137-29" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;当 k =&quot;</span>, k_values[i], <span class="st">&quot;时，交点 A(k) 的解为:&quot;</span>, solutions[i], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb137-30"><a href="#cb137-30" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 当 k = 4 时，交点 A(k) 的解为: 1.492103 
## 当 k = 5 时，交点 A(k) 的解为: 1.533559 
## 当 k = 6 时，交点 A(k) 的解为: 1.562741 
## 当 k = 7 时，交点 A(k) 的解为: 1.584431 
## 当 k = 8 时，交点 A(k) 的解为: 1.601157 
## 当 k = 9 时，交点 A(k) 的解为: 1.614538 
## 当 k = 10 时，交点 A(k) 的解为: 1.625358 
## 当 k = 11 时，交点 A(k) 的解为: 1.634409 
## 当 k = 12 时，交点 A(k) 的解为: 1.642026 
## 当 k = 13 时，交点 A(k) 的解为: 1.64851 
## 当 k = 14 时，交点 A(k) 的解为: 1.654182 
## 当 k = 15 时，交点 A(k) 的解为: 1.659098 
## 当 k = 16 时，交点 A(k) 的解为: 1.663408 
## 当 k = 17 时，交点 A(k) 的解为: 1.667286 
## 当 k = 18 时，交点 A(k) 的解为: 1.670754 
## 当 k = 19 时，交点 A(k) 的解为: 1.673823 
## 当 k = 20 时，交点 A(k) 的解为: 1.676618 
## 当 k = 21 时，交点 A(k) 的解为: 1.679157 
## 当 k = 22 时，交点 A(k) 的解为: 1.681473 
## 当 k = 23 时，交点 A(k) 的解为: 1.683596 
## 当 k = 24 时，交点 A(k) 的解为: 1.685547 
## 当 k = 25 时，交点 A(k) 的解为: 1.687348 
## 当 k = 100 时，交点 A(k) 的解为: 1.720626 
## 当 k = 500 时，交点 A(k) 的解为: 1.729745 
## 当 k = 1000 时，交点 A(k) 的解为: 1.730897</code></pre>
<p>可以发现，11.5中使等式成立的解和11.4中的解相同</p>
</div>
<div id="第七次第三题" class="section level2">
<h2>第七次第三题</h2>
<p>问题描述为：Suppose <span class="math inline">\(T_1, \ldots,
T_n\)</span> are i.i.d. samples drawn from the exponential distribution
with expectation <span class="math inline">\(\lambda\)</span>. Those
values greater than <span class="math inline">\(\tau\)</span> are not
observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i=T_i l\left(T_i \leq \tau\right)+\tau
l\left(T_i&gt;\tau\right)\)</span>, <span class="math inline">\(i=1,
\ldots, n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span>
and the observed <span class="math inline">\(Y_i\)</span> values are as
follows: <span class="math display">\[
0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85
\]</span></p>
<p>Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the
observed data MLE (note: <span class="math inline">\(Y_i\)</span>
follows a mixture distribution).</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a><span class="co"># 初始化数据</span></span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a>observed_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># 截尾点</span></span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(observed_data)</span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a></span>
<span id="cb139-6"><a href="#cb139-6" tabindex="-1"></a><span class="co"># E-M 算法</span></span>
<span id="cb139-7"><a href="#cb139-7" tabindex="-1"></a>estimate_lambda_em <span class="ot">&lt;-</span> <span class="cf">function</span>(data, tau, <span class="at">tol =</span> <span class="fl">1e-6</span>, <span class="at">max_iter =</span> <span class="dv">1000</span>) {</span>
<span id="cb139-8"><a href="#cb139-8" tabindex="-1"></a>  <span class="co"># 初始化 lambda</span></span>
<span id="cb139-9"><a href="#cb139-9" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(data)  <span class="co"># 初始值</span></span>
<span id="cb139-10"><a href="#cb139-10" tabindex="-1"></a>  </span>
<span id="cb139-11"><a href="#cb139-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb139-12"><a href="#cb139-12" tabindex="-1"></a>    <span class="co"># E 步骤: 计算每个被截尾值的期望</span></span>
<span id="cb139-13"><a href="#cb139-13" tabindex="-1"></a>    truncated_data <span class="ot">&lt;-</span> data[data <span class="sc">==</span> tau]  <span class="co"># 被截尾的值</span></span>
<span id="cb139-14"><a href="#cb139-14" tabindex="-1"></a>    untruncated_data <span class="ot">&lt;-</span> data[data <span class="sc">&lt;</span> tau]  <span class="co"># 未截尾的值</span></span>
<span id="cb139-15"><a href="#cb139-15" tabindex="-1"></a>    </span>
<span id="cb139-16"><a href="#cb139-16" tabindex="-1"></a>    <span class="co"># 对于截尾的观测值，计算其条件期望</span></span>
<span id="cb139-17"><a href="#cb139-17" tabindex="-1"></a>    expected_truncated <span class="ot">&lt;-</span> <span class="fu">sum</span>(truncated_data <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> lambda)</span>
<span id="cb139-18"><a href="#cb139-18" tabindex="-1"></a>    </span>
<span id="cb139-19"><a href="#cb139-19" tabindex="-1"></a>    <span class="co"># M 步骤: 更新 lambda</span></span>
<span id="cb139-20"><a href="#cb139-20" tabindex="-1"></a>    lambda_new <span class="ot">&lt;-</span> n <span class="sc">/</span> (<span class="fu">sum</span>(untruncated_data) <span class="sc">+</span> expected_truncated)</span>
<span id="cb139-21"><a href="#cb139-21" tabindex="-1"></a>    </span>
<span id="cb139-22"><a href="#cb139-22" tabindex="-1"></a>    <span class="co"># 检查收敛</span></span>
<span id="cb139-23"><a href="#cb139-23" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(lambda <span class="sc">-</span> lambda_new) <span class="sc">&lt;</span> tol) <span class="cf">break</span></span>
<span id="cb139-24"><a href="#cb139-24" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb139-25"><a href="#cb139-25" tabindex="-1"></a>  }</span>
<span id="cb139-26"><a href="#cb139-26" tabindex="-1"></a>  </span>
<span id="cb139-27"><a href="#cb139-27" tabindex="-1"></a>  <span class="fu">return</span>(lambda)</span>
<span id="cb139-28"><a href="#cb139-28" tabindex="-1"></a>}</span>
<span id="cb139-29"><a href="#cb139-29" tabindex="-1"></a></span>
<span id="cb139-30"><a href="#cb139-30" tabindex="-1"></a><span class="co"># 计算 EM 算法的 lambda</span></span>
<span id="cb139-31"><a href="#cb139-31" tabindex="-1"></a>lambda_em <span class="ot">&lt;-</span> <span class="fu">estimate_lambda_em</span>(observed_data, tau)</span>
<span id="cb139-32"><a href="#cb139-32" tabindex="-1"></a></span>
<span id="cb139-33"><a href="#cb139-33" tabindex="-1"></a><span class="co"># 使用观测数据直接计算 MLE</span></span>
<span id="cb139-34"><a href="#cb139-34" tabindex="-1"></a>observed_untruncated <span class="ot">&lt;-</span> observed_data[observed_data <span class="sc">&lt;</span> tau]</span>
<span id="cb139-35"><a href="#cb139-35" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(observed_untruncated)</span>
<span id="cb139-36"><a href="#cb139-36" tabindex="-1"></a></span>
<span id="cb139-37"><a href="#cb139-37" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb139-38"><a href="#cb139-38" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;EM 算法估计的 λ:&quot;</span>, lambda_em, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## EM 算法估计的 λ: 1.037038</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;使用观测数据直接计算的 MLE λ:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 使用观测数据直接计算的 MLE λ: 1.866667</code></pre>
</div>
</div>
<div id="第八次作业" class="section level1">
<h1>第八次作业</h1>
<div id="第八次第一题" class="section level2">
<h2>第八次第一题</h2>
<p>问题描述为：Use the simplex algorithm to solve the following problem.
Minimize <span class="math inline">\(4 x+2 y+9 z\)</span> subject to
<span class="math display">\[
\begin{aligned}
&amp; 2 x+y+z \leq 2 \\
&amp; x-y+3 z \leq 3 \\
&amp; x \geq 0, y \geq 0, z \geq 0
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co">#for simplex function</span></span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb143-3"><a href="#cb143-3" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb143-4"><a href="#cb143-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb143-5"><a href="#cb143-5" tabindex="-1"></a><span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">maxi =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Linear Programming Results
## 
## Call : simplex(a = a, A1 = A1, b1 = b1, maxi = FALSE)
## 
## Minimization Problem with Objective Function Coefficients
## x1 x2 x3 
##  4  2  9 
## 
## 
## Optimal solution has the following values
## x1 x2 x3 
##  0  0  0 
## The optimal value of the objective  function is 0.</code></pre>
<p>最小值为0，当取值为(0,0,0)时取到</p>
</div>
<div id="第八次第二题" class="section level2">
<h2>第八次第二题</h2>
<p>题目描述为：Use both for loops and lapply() to fit linear models to
the mtcars using the formulas stored in this list:</p>
<pre><code>formulas &lt;- list(
    mpg ~ disp,
    mpg ~ I(1 / disp),
    mpg ~ disp + wt,
    mpg ~ I(1 / disp) + wt
)</code></pre>
<p>使用for循环的情况如下：</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a><span class="co"># 定义公式列表</span></span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb146-3"><a href="#cb146-3" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb146-4"><a href="#cb146-4" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb146-5"><a href="#cb146-5" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb146-6"><a href="#cb146-6" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb146-7"><a href="#cb146-7" tabindex="-1"></a>)</span>
<span id="cb146-8"><a href="#cb146-8" tabindex="-1"></a></span>
<span id="cb146-9"><a href="#cb146-9" tabindex="-1"></a><span class="co"># 初始化一个空列表存储模型</span></span>
<span id="cb146-10"><a href="#cb146-10" tabindex="-1"></a>models_for_1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb146-11"><a href="#cb146-11" tabindex="-1"></a></span>
<span id="cb146-12"><a href="#cb146-12" tabindex="-1"></a><span class="co"># 使用for循环拟合模型</span></span>
<span id="cb146-13"><a href="#cb146-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb146-14"><a href="#cb146-14" tabindex="-1"></a>  models_for_1[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb146-15"><a href="#cb146-15" tabindex="-1"></a>}</span>
<span id="cb146-16"><a href="#cb146-16" tabindex="-1"></a></span>
<span id="cb146-17"><a href="#cb146-17" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb146-18"><a href="#cb146-18" tabindex="-1"></a>models_for_1</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>使用lapply函数的情况如下：</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="co"># 使用lapply()拟合模型</span></span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a>models_lapply_1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="fu">lm</span>(f, <span class="at">data =</span> mtcars))</span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a>models_lapply_1</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>可以看出，使用两种方式算出的结果是相同的</p>
</div>
<div id="第八次第三题" class="section level2">
<h2>第八次第三题</h2>
<p>题目描述为：Fit the model mpg ~ disp to each of the bootstrap
replicates of mtcars in the list below by using a for loop and lapply().
Can you do it without an anonymous function?</p>
<pre><code>bootstraps &lt;- lapply(1:10, function(i) {
    rows &lt;- sample(1:nrow(mtcars), rep = TRUE)
    mtcars[rows, ]
})</code></pre>
<p>使用for循环的情况如下：</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb151-2"><a href="#cb151-2" tabindex="-1"></a><span class="co"># 创建bootstrap样本列表</span></span>
<span id="cb151-3"><a href="#cb151-3" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb151-4"><a href="#cb151-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb151-5"><a href="#cb151-5" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb151-6"><a href="#cb151-6" tabindex="-1"></a>  bootstraps[[i]] <span class="ot">&lt;-</span> mtcars[rows, ]</span>
<span id="cb151-7"><a href="#cb151-7" tabindex="-1"></a>}</span>
<span id="cb151-8"><a href="#cb151-8" tabindex="-1"></a></span>
<span id="cb151-9"><a href="#cb151-9" tabindex="-1"></a>models_for_2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb151-10"><a href="#cb151-10" tabindex="-1"></a></span>
<span id="cb151-11"><a href="#cb151-11" tabindex="-1"></a><span class="co"># 对每个bootstrap样本拟合模型</span></span>
<span id="cb151-12"><a href="#cb151-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)) {</span>
<span id="cb151-13"><a href="#cb151-13" tabindex="-1"></a>  models_for_2[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb151-14"><a href="#cb151-14" tabindex="-1"></a>}</span>
<span id="cb151-15"><a href="#cb151-15" tabindex="-1"></a></span>
<span id="cb151-16"><a href="#cb151-16" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb151-17"><a href="#cb151-17" tabindex="-1"></a>models_for_2</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     26.4707      -0.0296  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.58356     -0.04291  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.30606     -0.04375  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.34619     -0.04572  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.17123     -0.04688  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.15068     -0.04413  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.70607     -0.04714  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.8303      -0.0402  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.28341     -0.03452  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.53057     -0.03053</code></pre>
<p>使用lapply函数的情况如下：</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb153-2"><a href="#cb153-2" tabindex="-1"></a><span class="co"># 定义一个函数生成bootstrap样本</span></span>
<span id="cb153-3"><a href="#cb153-3" tabindex="-1"></a>generate_bootstrap <span class="ot">&lt;-</span> <span class="cf">function</span>(index) {</span>
<span id="cb153-4"><a href="#cb153-4" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb153-5"><a href="#cb153-5" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb153-6"><a href="#cb153-6" tabindex="-1"></a>}</span>
<span id="cb153-7"><a href="#cb153-7" tabindex="-1"></a></span>
<span id="cb153-8"><a href="#cb153-8" tabindex="-1"></a><span class="co"># 使用lapply()生成bootstrap样本</span></span>
<span id="cb153-9"><a href="#cb153-9" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, generate_bootstrap)</span>
<span id="cb153-10"><a href="#cb153-10" tabindex="-1"></a></span>
<span id="cb153-11"><a href="#cb153-11" tabindex="-1"></a><span class="co"># 定义一个函数拟合模型</span></span>
<span id="cb153-12"><a href="#cb153-12" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb153-13"><a href="#cb153-13" tabindex="-1"></a>  <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> data)</span>
<span id="cb153-14"><a href="#cb153-14" tabindex="-1"></a>}</span>
<span id="cb153-15"><a href="#cb153-15" tabindex="-1"></a></span>
<span id="cb153-16"><a href="#cb153-16" tabindex="-1"></a><span class="co"># 使用lapply()对每个bootstrap样本拟合模型</span></span>
<span id="cb153-17"><a href="#cb153-17" tabindex="-1"></a>models_lapply_2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, fit_model)</span>
<span id="cb153-18"><a href="#cb153-18" tabindex="-1"></a></span>
<span id="cb153-19"><a href="#cb153-19" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb153-20"><a href="#cb153-20" tabindex="-1"></a>models_lapply_2</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##     26.4707      -0.0296  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.58356     -0.04291  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.30606     -0.04375  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.34619     -0.04572  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.17123     -0.04688  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    31.15068     -0.04413  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.70607     -0.04714  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##     29.8303      -0.0402  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.28341     -0.03452  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.53057     -0.03053</code></pre>
</div>
<div id="第八次第四题" class="section level2">
<h2>第八次第四题</h2>
<p>题目描述为：For each model in the previous two exercises, extract
<span class="math inline">\(R^2\)</span> using the function below. rsq
&lt;- function(mod) summary(mod)$r.squared</p>
<p>第二题中模型的<span class="math inline">\(R^2\)</span>为：</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a>r_lapply_1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(models_lapply_1, <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared)</span>
<span id="cb155-2"><a href="#cb155-2" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" tabindex="-1"></a><span class="fu">unlist</span>(r_lapply_1)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<p>第三题中的模型的<span class="math inline">\(R^2\)</span>为：</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" tabindex="-1"></a>r_lapply_2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(models_lapply_2, <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared)</span>
<span id="cb157-2"><a href="#cb157-2" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" tabindex="-1"></a><span class="fu">unlist</span>(r_lapply_2)</span></code></pre></div>
<pre><code>##  [1] 0.5491998 0.6804651 0.6946612 0.7952022 0.8062361 0.8057083 0.8061748
##  [8] 0.6943378 0.6041705 0.6102182</code></pre>
</div>
<div id="第八次第五题" class="section level2">
<h2>第八次第五题</h2>
<p>问题描述为： The following code simulates the performance of a t-test
for non-normal data. Use sapply() and an anonymous function to extract
the p-value from every trial.</p>
<pre><code>trials &lt;- replicate(
    100,
    t.test(rpois(10, 10), rpois(7, 10)),
    simplify = FALSE
)</code></pre>
<p>Extra challenge: get rid of the anonymous function by using [[
directly.</p>
<p>使用sapply函数：</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb160-2"><a href="#cb160-2" tabindex="-1"></a><span class="co"># 模拟100次t检验</span></span>
<span id="cb160-3"><a href="#cb160-3" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb160-4"><a href="#cb160-4" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb160-5"><a href="#cb160-5" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb160-6"><a href="#cb160-6" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb160-7"><a href="#cb160-7" tabindex="-1"></a>)</span>
<span id="cb160-8"><a href="#cb160-8" tabindex="-1"></a></span>
<span id="cb160-9"><a href="#cb160-9" tabindex="-1"></a><span class="co"># 使用sapply()和匿名函数提取p值</span></span>
<span id="cb160-10"><a href="#cb160-10" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="sc">$</span>p.value)</span>
<span id="cb160-11"><a href="#cb160-11" tabindex="-1"></a></span>
<span id="cb160-12"><a href="#cb160-12" tabindex="-1"></a><span class="co"># 查看部分结果</span></span>
<span id="cb160-13"><a href="#cb160-13" tabindex="-1"></a><span class="fu">head</span>(p_values)</span></code></pre></div>
<pre><code>## [1] 0.1259499 0.8009303 0.9528553 0.4529599 0.4830835 0.3206111</code></pre>
<p>避免使用匿名函数：</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb162-2"><a href="#cb162-2" tabindex="-1"></a><span class="co"># 使用sapply()直接提取p值</span></span>
<span id="cb162-3"><a href="#cb162-3" tabindex="-1"></a>p_values_direct <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb162-4"><a href="#cb162-4" tabindex="-1"></a></span>
<span id="cb162-5"><a href="#cb162-5" tabindex="-1"></a><span class="co"># 查看部分结果</span></span>
<span id="cb162-6"><a href="#cb162-6" tabindex="-1"></a><span class="fu">head</span>(p_values_direct)</span></code></pre></div>
<pre><code>## [1] 0.1259499 0.8009303 0.9528553 0.4529599 0.4830835 0.3206111</code></pre>
</div>
<div id="第八次第六题" class="section level2">
<h2>第八次第六题</h2>
<p>题目描述为：Implement a combination of Map() and vapply() to create
an lapply() variant that iterates in parallel over all of its inputs and
stores its outputs in a vector (or a matrix). What arguments should the
function take?</p>
<p>我们构造的符合函数是：</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a>Map_vapply <span class="ot">&lt;-</span> <span class="cf">function</span>(FUN, ..., FUN.VALUE) {</span>
<span id="cb164-2"><a href="#cb164-2" tabindex="-1"></a>  <span class="co"># 使用 Map() 对所有输入进行并行迭代</span></span>
<span id="cb164-3"><a href="#cb164-3" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">Map</span>(FUN, ...)</span>
<span id="cb164-4"><a href="#cb164-4" tabindex="-1"></a>  </span>
<span id="cb164-5"><a href="#cb164-5" tabindex="-1"></a>  <span class="co"># 使用 vapply() 将结果强制转换为向量或矩阵</span></span>
<span id="cb164-6"><a href="#cb164-6" tabindex="-1"></a>  <span class="fu">vapply</span>(results, identity, FUN.VALUE)</span>
<span id="cb164-7"><a href="#cb164-7" tabindex="-1"></a>}</span></code></pre></div>
<p>我们对上一题使用这个函数，计算每次t检验的p值</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb165-2"><a href="#cb165-2" tabindex="-1"></a>list1 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100</span>,<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>),<span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb165-3"><a href="#cb165-3" tabindex="-1"></a>list2 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100</span>,<span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>),<span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb165-4"><a href="#cb165-4" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">Map_vapply</span>(<span class="at">FUN =</span> <span class="cf">function</span>(x,y) <span class="fu">t.test</span>(x,y)<span class="sc">$</span>p.value,list1,list2,<span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## [1] 0.56244291 0.33841773 0.83636176 0.38279981 0.06709744 0.68706097</code></pre>
</div>
<div id="第八次第七题" class="section level2">
<h2>第八次第七题</h2>
<p>问题描述为：Make a faster version of chisq.test() that only computes
the chi-square test statistic when the input is two numeric vectors with
no missing values. You can try simplifying chisq.test() or by coding
from the mathematical definition</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb167-2"><a href="#cb167-2" tabindex="-1"></a>  <span class="co"># 生成列联表（contingency table）</span></span>
<span id="cb167-3"><a href="#cb167-3" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb167-4"><a href="#cb167-4" tabindex="-1"></a>  </span>
<span id="cb167-5"><a href="#cb167-5" tabindex="-1"></a>  <span class="co"># 计算行总计和列总计</span></span>
<span id="cb167-6"><a href="#cb167-6" tabindex="-1"></a>  row_sums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(tbl)</span>
<span id="cb167-7"><a href="#cb167-7" tabindex="-1"></a>  col_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(tbl)</span>
<span id="cb167-8"><a href="#cb167-8" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl)</span>
<span id="cb167-9"><a href="#cb167-9" tabindex="-1"></a>  </span>
<span id="cb167-10"><a href="#cb167-10" tabindex="-1"></a>  <span class="co"># 计算期望频数</span></span>
<span id="cb167-11"><a href="#cb167-11" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sums, col_sums, <span class="st">&quot;*&quot;</span>) <span class="sc">/</span> total</span>
<span id="cb167-12"><a href="#cb167-12" tabindex="-1"></a>  </span>
<span id="cb167-13"><a href="#cb167-13" tabindex="-1"></a>  <span class="co"># 计算卡方统计量</span></span>
<span id="cb167-14"><a href="#cb167-14" tabindex="-1"></a>  chisq_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((tbl <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb167-15"><a href="#cb167-15" tabindex="-1"></a>  </span>
<span id="cb167-16"><a href="#cb167-16" tabindex="-1"></a>  <span class="fu">return</span>(chisq_stat)</span>
<span id="cb167-17"><a href="#cb167-17" tabindex="-1"></a>}</span>
<span id="cb167-18"><a href="#cb167-18" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb167-19"><a href="#cb167-19" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb167-20"><a href="#cb167-20" tabindex="-1"></a></span>
<span id="cb167-21"><a href="#cb167-21" tabindex="-1"></a><span class="co"># 使用快速卡方检验</span></span>
<span id="cb167-22"><a href="#cb167-22" tabindex="-1"></a><span class="fu">fast_chisq_test</span>(x, y)</span></code></pre></div>
<pre><code>## [1] 0.4</code></pre>
</div>
<div id="第八次第八题" class="section level2">
<h2>第八次第八题</h2>
<p>问题描述为：Can you make a faster version of table() for the case of
an input of two integer vectors with no missing values? Can you use it
to speed up your chi-square test?</p>
<p>快速table函数：</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb169-2"><a href="#cb169-2" tabindex="-1"></a>  <span class="co"># 确定值的范围</span></span>
<span id="cb169-3"><a href="#cb169-3" tabindex="-1"></a>  x_levels <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(x))</span>
<span id="cb169-4"><a href="#cb169-4" tabindex="-1"></a>  y_levels <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(y))</span>
<span id="cb169-5"><a href="#cb169-5" tabindex="-1"></a>  </span>
<span id="cb169-6"><a href="#cb169-6" tabindex="-1"></a>  <span class="co"># 创建零初始化的频数矩阵</span></span>
<span id="cb169-7"><a href="#cb169-7" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(x_levels), <span class="at">ncol =</span> <span class="fu">length</span>(y_levels),</span>
<span id="cb169-8"><a href="#cb169-8" tabindex="-1"></a>                <span class="at">dimnames =</span> <span class="fu">list</span>(x_levels, y_levels))</span>
<span id="cb169-9"><a href="#cb169-9" tabindex="-1"></a>  </span>
<span id="cb169-10"><a href="#cb169-10" tabindex="-1"></a>  <span class="co"># 填充频数矩阵</span></span>
<span id="cb169-11"><a href="#cb169-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb169-12"><a href="#cb169-12" tabindex="-1"></a>    tbl[x[i], y[i]] <span class="ot">&lt;-</span> tbl[x[i], y[i]] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb169-13"><a href="#cb169-13" tabindex="-1"></a>  }</span>
<span id="cb169-14"><a href="#cb169-14" tabindex="-1"></a>  </span>
<span id="cb169-15"><a href="#cb169-15" tabindex="-1"></a>  <span class="fu">return</span>(tbl)</span>
<span id="cb169-16"><a href="#cb169-16" tabindex="-1"></a>}</span></code></pre></div>
<p>使用快速table的快速卡方检验：</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a>fast_chisq_test1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb170-2"><a href="#cb170-2" tabindex="-1"></a>  <span class="co"># 使用快速 table() 构造列联表</span></span>
<span id="cb170-3"><a href="#cb170-3" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb170-4"><a href="#cb170-4" tabindex="-1"></a>  </span>
<span id="cb170-5"><a href="#cb170-5" tabindex="-1"></a>  <span class="co"># 计算行和、列和以及总和</span></span>
<span id="cb170-6"><a href="#cb170-6" tabindex="-1"></a>  row_sums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(tbl)</span>
<span id="cb170-7"><a href="#cb170-7" tabindex="-1"></a>  col_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(tbl)</span>
<span id="cb170-8"><a href="#cb170-8" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl)</span>
<span id="cb170-9"><a href="#cb170-9" tabindex="-1"></a>  </span>
<span id="cb170-10"><a href="#cb170-10" tabindex="-1"></a>  <span class="co"># 计算期望频数矩阵</span></span>
<span id="cb170-11"><a href="#cb170-11" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sums, col_sums, <span class="st">&quot;*&quot;</span>) <span class="sc">/</span> total</span>
<span id="cb170-12"><a href="#cb170-12" tabindex="-1"></a>  </span>
<span id="cb170-13"><a href="#cb170-13" tabindex="-1"></a>  <span class="co"># 计算卡方统计量</span></span>
<span id="cb170-14"><a href="#cb170-14" tabindex="-1"></a>  chisq_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((tbl <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb170-15"><a href="#cb170-15" tabindex="-1"></a>  </span>
<span id="cb170-16"><a href="#cb170-16" tabindex="-1"></a>  <span class="fu">return</span>(chisq_stat)</span>
<span id="cb170-17"><a href="#cb170-17" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb171-2"><a href="#cb171-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fl">1e5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb171-3"><a href="#cb171-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fl">1e5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb171-4"><a href="#cb171-4" tabindex="-1"></a>tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb171-5"><a href="#cb171-5" tabindex="-1"></a>chisq_stat <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(x, y)<span class="sc">$</span>statistic</span>
<span id="cb171-6"><a href="#cb171-6" tabindex="-1"></a>chisq_stat_fast <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb171-7"><a href="#cb171-7" tabindex="-1"></a>chisq_stat <span class="sc">-</span> chisq_stat_fast</span></code></pre></div>
<pre><code>## X-squared 
##         0</code></pre>
</div>
</div>
<div id="第九次作业" class="section level1">
<h1>第九次作业</h1>
<div id="第九次第一题" class="section level2">
<h2>第九次第一题</h2>
<p>问题描述为：This example appears in [40]. Consider the bivariate
density <span class="math display">\[
f(x, y) \propto\binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1,
\ldots, n, 0 \leq y \leq 1
\]</span></p>
<p>It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions
are <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span>
and <span class="math inline">\(\operatorname{Beta}(x+a,
n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target
joint density <span class="math inline">\(f(x, y)\)</span>.Write an Rcpp
function for Exercise 9.8 (page 278, Statistical Computing with
R).Compare the corresponding generated random numbers with those by the
R function you wrote using the function “qqplot”Campare the computation
time of the two functions with the function “microbenchmark”.</p>
<p>以下是Rcpp的实现代码：</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb173-1"><a href="#cb173-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb173-2"><a href="#cb173-2" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp<span class="op">;</span></span>
<span id="cb173-3"><a href="#cb173-3" tabindex="-1"></a></span>
<span id="cb173-4"><a href="#cb173-4" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb173-5"><a href="#cb173-5" tabindex="-1"></a>NumericMatrix gibbs_rcpp<span class="op">(</span><span class="dt">int</span> n_samples<span class="op">,</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">double</span> a<span class="op">,</span> <span class="dt">double</span> b<span class="op">,</span> <span class="dt">int</span> x_init<span class="op">,</span> <span class="dt">double</span> y_init<span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-6"><a href="#cb173-6" tabindex="-1"></a>  NumericMatrix samples<span class="op">(</span>n_samples<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb173-7"><a href="#cb173-7" tabindex="-1"></a>  <span class="dt">int</span> x <span class="op">=</span> x_init<span class="op">;</span></span>
<span id="cb173-8"><a href="#cb173-8" tabindex="-1"></a>  <span class="dt">double</span> y <span class="op">=</span> y_init<span class="op">;</span></span>
<span id="cb173-9"><a href="#cb173-9" tabindex="-1"></a>  </span>
<span id="cb173-10"><a href="#cb173-10" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n_samples<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-11"><a href="#cb173-11" tabindex="-1"></a>    <span class="co">// Update x ~ Binomial(n, y)</span></span>
<span id="cb173-12"><a href="#cb173-12" tabindex="-1"></a>    x <span class="op">=</span> R<span class="op">::</span>rbinom<span class="op">(</span>n<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb173-13"><a href="#cb173-13" tabindex="-1"></a>    </span>
<span id="cb173-14"><a href="#cb173-14" tabindex="-1"></a>    <span class="co">// Update y ~ Beta(x+a, n-x+b)</span></span>
<span id="cb173-15"><a href="#cb173-15" tabindex="-1"></a>    y <span class="op">=</span> R<span class="op">::</span>rbeta<span class="op">(</span>x <span class="op">+</span> a<span class="op">,</span> n <span class="op">-</span> x <span class="op">+</span> b<span class="op">);</span></span>
<span id="cb173-16"><a href="#cb173-16" tabindex="-1"></a>    </span>
<span id="cb173-17"><a href="#cb173-17" tabindex="-1"></a>    <span class="co">// Store the samples</span></span>
<span id="cb173-18"><a href="#cb173-18" tabindex="-1"></a>    samples<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">)</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb173-19"><a href="#cb173-19" tabindex="-1"></a>    samples<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb173-20"><a href="#cb173-20" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb173-21"><a href="#cb173-21" tabindex="-1"></a>  </span>
<span id="cb173-22"><a href="#cb173-22" tabindex="-1"></a>  <span class="cf">return</span> samples<span class="op">;</span></span>
<span id="cb173-23"><a href="#cb173-23" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>以下是R的实现代码：</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a>gibbs_r <span class="ot">&lt;-</span> <span class="cf">function</span>(n_samples, n, a, b, x_init, y_init) {</span>
<span id="cb174-2"><a href="#cb174-2" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n_samples, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb174-3"><a href="#cb174-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x_init</span>
<span id="cb174-4"><a href="#cb174-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y_init</span>
<span id="cb174-5"><a href="#cb174-5" tabindex="-1"></a>  </span>
<span id="cb174-6"><a href="#cb174-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_samples) {</span>
<span id="cb174-7"><a href="#cb174-7" tabindex="-1"></a>    <span class="co"># Update x ~ Binomial(n, y)</span></span>
<span id="cb174-8"><a href="#cb174-8" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb174-9"><a href="#cb174-9" tabindex="-1"></a>    </span>
<span id="cb174-10"><a href="#cb174-10" tabindex="-1"></a>    <span class="co"># Update y ~ Beta(x+a, n-x+b)</span></span>
<span id="cb174-11"><a href="#cb174-11" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb174-12"><a href="#cb174-12" tabindex="-1"></a>    </span>
<span id="cb174-13"><a href="#cb174-13" tabindex="-1"></a>    <span class="co"># Store the samples</span></span>
<span id="cb174-14"><a href="#cb174-14" tabindex="-1"></a>    samples[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb174-15"><a href="#cb174-15" tabindex="-1"></a>  }</span>
<span id="cb174-16"><a href="#cb174-16" tabindex="-1"></a>  </span>
<span id="cb174-17"><a href="#cb174-17" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb174-18"><a href="#cb174-18" tabindex="-1"></a>}</span></code></pre></div>
<p>使用 qqplot 比较Rcpp和R生成的随机数是否一致：</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb175-2"><a href="#cb175-2" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb175-3"><a href="#cb175-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb175-4"><a href="#cb175-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb175-5"><a href="#cb175-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb175-6"><a href="#cb175-6" tabindex="-1"></a>x_init <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb175-7"><a href="#cb175-7" tabindex="-1"></a>y_init <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb175-8"><a href="#cb175-8" tabindex="-1"></a></span>
<span id="cb175-9"><a href="#cb175-9" tabindex="-1"></a><span class="co"># 调用Rcpp和R函数</span></span>
<span id="cb175-10"><a href="#cb175-10" tabindex="-1"></a>samples_rcpp <span class="ot">&lt;-</span> <span class="fu">gibbs_rcpp</span>(n_samples, n, a, b, x_init, y_init)</span>
<span id="cb175-11"><a href="#cb175-11" tabindex="-1"></a>samples_r <span class="ot">&lt;-</span> <span class="fu">gibbs_r</span>(n_samples, n, a, b, x_init, y_init)</span>
<span id="cb175-12"><a href="#cb175-12" tabindex="-1"></a></span>
<span id="cb175-13"><a href="#cb175-13" tabindex="-1"></a><span class="co"># QQ图比较x的分布</span></span>
<span id="cb175-14"><a href="#cb175-14" tabindex="-1"></a><span class="fu">qqplot</span>(samples_r[, <span class="dv">1</span>], samples_rcpp[, <span class="dv">1</span>], <span class="at">main =</span> <span class="st">&quot;QQ Plot of x&quot;</span>)</span>
<span id="cb175-15"><a href="#cb175-15" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAolBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmZjpmkGZmkJBmkLZmkNtmtrZmtttmtv+QOgCQOjqQZgCQkGaQtpCQ2/+2ZgC2Zjq2ZpC225C22/+2/7a2///bkDrbtpDb27bb/7bb////AAD/tmb/25D/27b//7b//9v///+6h8xQAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALt0lEQVR4nO2dAZujthGG8SW3viZtbp1rk7TdTZvl2jSkXeNb8///WpEEGISkT0iD0LLzPc96jZEl8VoaDWIQRcNyqti6ArmLAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBAqQFdf/9zURTf/v3ZuNmqKpT++Gu797F4/6x9/1+/mXL9fCyKj6tUODGgl0/d8X/9q2FTqAdUHJ4MgL58emcCVIsv3K9S47SA2iPuJQ5U25QaALVs5oDKwgioEjjXUVpA7dEfRHf6/Sh/cG2zSyIRfDm1x9wDEv3wq5+eBZ8xy+nHCtHlKPa3XzSCDFBSQG29u1/65aQayHhTpekAyUbRAar6FjUFpH3cZVUJ1u3LA1GdkwJqOdx1b8v2gLRN9a4D9N9T+18BahtF+yoPfNzFxh+Pupig/stxZtyDlRRQe0y3nnR40jb7d7oN6qDIfyNA44/HNqjNtSA0SfkC6kex3hDJJDdAk48nRrokHdG26GLVx2dpRbVNlaYDdPiu94P6jlgLu3IDNPl4Aqg+Uo5pGxjp9tAOfykGIz1sqjTVaPwJakHSdyAzQVsM86231/l12maXRAO01Aa1mX5D2MfSAmpby80Ezzal5oAsw5Xj4/+d6DpZ4lONL58GGyw8PG1TaA5o5PDIc4q5HzQCpLptm+xOLzpQG52s/tD5ztpmYwSkXOa/yk8+j87bbh/fANUqo5LMU9xquuP6+U/P9s2MxPNBQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQArQKIpgEibJGgCNr2TXDOgmBgTENgiIAQERAypei87LAI1HsSgDlH+DbI+wac5n74p2Ca+PNIY5e0CigqL5LAXUEiIJ6ssdkKifbD6LATV1TFDfrYOG55FEonvJ1+WAyCqQtYqzsM4MyCppnPs/L70pQKL5dGaAARk09n0Y0EzniW/IgHRprjMDmuqsn1qEA6qi7mfMD5A6tdC2uQUNUq7zdJuH+Zskn1Gtiv51ISCyGcX8AJ0nZ6YMSJOa96EANJlN2g2g81m3N2yDxpInptoMA49ig2a+z1ghgGQ/i7zhPCNA7lnnAEC19A+ruPupswHkbD5NCKDroxrISlcbKoviTq5sYJt9zACQ5jpbZjmXA3r5XjUd1xhfyXUQ7kRvtKxssD0gzXW2jVjhLaiyt6Dr4/3QEy2pNgekuc7F6HWWzjtDJTVrXznm7qU7qVqY1s7ymbTXXGdCQB7XDl9FC5q6zpQtyEODDZKoorNbQTPXmc4GeSnzUexscJ3JRrEdOIreAQnNm3QUkWs41UqOIl255FqEZy1HkbDciCJMp+dn6DrruXgX17/xcBQpy40qYTbBY5h09sjGuzwl7Cguym4l6Y6NOrMwTBl65eNdYEMVZLYFIPOks1c+3gWSKT2gPp7Fst+dj3eBZEpug6yTzh7ZeJfXSQzwdeQKjYlHsVE8i3G/Ixfv4oZ3ygF6OUXFKqb1gxb6PmOFGGk1fGXvBw1a5jprCvGDVOeqXgugGDxBXUx5QJdjlBFKBiiq+TRhRppiKe81AJnmLyLx7GqYN8yAxTafJsYGJSp3YY6TOdQzQTHho1hYcetN2s8ATeNZ4rJdlJDkPsP1AWnxLHHZLkk4nKzmNsxPbNA8niUiV9qEm2Sn8rx1XFM8S2CmMQmvPweP9av6QQSD16A9AiLEs0dAlM2ned2AzLPyBBlPMo1JuC0g0wwYcfNpXjMg46w8fdfdEyAa19lYTGDCvAARuc7GYgIT5mSDyFxnQym0CdNlN5mV17bJFABIBGZWsfEvtIdCP3gNCruqcTneNWU+VzXWwxM6HyQuz2dzVWPF5tOEAirFw94woMvROrcWAsh85W9VPGFd7O7lJB65aO9iHvENAYBMnnOxbvNpAo20fDauywR1F6ZJW5DJc278l/cJ1UrDvGhjJkARc9IGQOcVTi3MxVIm7FQentZuQdN4lpUUAkg+kbpEF3+q4p7WSGs26JyET9BVjcNTJYw0InQ5frXiKGaIZ1lFywGJC4cigBMP89dHexxj5KGtPngNCvODBKAtHcVkeGJa0HaB5OmaTxNhg7YLA06JJ3gUSxP+YoxnScsn6/kgbVxXpxa01fCrBG1Csuw0z1BdtEgwsJtqQZmQLLs5oDUm5f1q4Z0w5WK3OqBErrOxFpQJ6bLTZuXXmZT3qQRtQsLsxvEsqU4tZnUISLjBPavJB69BYY5ik/ae1dS+z1ghpxqp71ndEE/Qyep696yiu0y3UHgLor9n1TQrvzGeMBu00j2rpln5BJPOQCHzQRG+omvS3jDpvIXrrCkjP2gGaJ14loXKCJDuOW/kOmsKANT3sXVHsdXiWRYqZBSLdKJ9yt188BoUNmm/drnZ4AmdtF+33HyaTxNkgy4f4qaj7eUmiWdZqBBAx5WMtJp0zotPUBejePqRzQ9KP+kMlJGRLtLEsyxURkY6UTzLQmVkpLeZlEeKOFklNtJbTToD5XIultvgNSgTQLniyeRkNdvm0wQBKt8/V3euAM1GBpe5IcrsOpsz4NmHDRLBibUIwXOc1Ff9Al7WlbyK4e/WfLKY/9EV5ihe/vCb/LNo5Co51pNWOU4XTc+PUJijKC79OACNnG3HiuTqosV0kn4PgGR4a3kP17TvEjtbUNDSj2kVMsyXd2Ikcw1iwzUhpw3SL1rsxAZ5qXcFrK1MNp+wlQ3TajNHMWffZ6wgR5HgntVz8Vq0HBDJPat6pkH743bHft2WnOaeVb86vFpAnves+mcatj9PQB73rAZkGrQ/U0Ae96wuzzRof6aACMWAIjNlQHH7GdCbB7QnMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBA9oNq9QoqMoHHHi7pumxXR3K5Jz6qwP2e5jzsANZyKHJC4ebq2l399bPdVzmOsHdfmRICOa9pc3LRd2wi9nNSj4N011EQNSAU42C+uqQAt16UTudacM3f7t9WUuqX0WgV+oRpqogaEAQi5fsDq/T+sgFCosgtQXdzLa35+NRxEDkgeArr6WNr3txnYbVD97j8npwVzdjFVLb8aDqIGpNoG6OKOZ3GKDmAHVIlO4rw05TTAkopXDW/aAlDtsNHudebUwhmOX180TftTCHMA5NGAXc9ylV93AJL52iNxgX3JoYthE1g5bUgXnGIhoA7LbqpB68jBSMNB1GNpB3sLUmGk9l9fHbx1f53BMI/cMJ/HlDo8aWGiXDduedigjR1F2UtcXo7qQs76uU41anCiUrr2d03LXUNNfLIKxICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBBQvoDw6ruX4zTcU0T5Xh9jH9Oo6XUDmqQYRfkSaj+AuijfPQCSa5+LYyvV/8vxbyJ2VXz80Fw+/HKUESwSUNVFswxf6fTy/T+Ld/8eA+qjfHcASP7wIlZXRHlV8vHsMvperc3TolALGclnK8u997ev9JIPvtdjFfcCqI+Qkw/sEgcpQ8K6lwcVHyafW/6gHl3epp8F1ck9ewXUGVOpWvaq40MzvHRhhoenFpA61vaT8Ve6PB72C0jd8KMMjLQjU0AfukBVAWiIee2/0mvfgITKw9PAxQ5ocqzlaGv/gMThy7j3eReTUbqdDXqYfmX6fq+A5BHUqgW9nIp7HVB3P0o/iomW039lyGPXgGQorzgKGY477msK0I/SH7r5QaqhTUN3B0DjO1t2A8gp95Lo86SXj9qnDGiatNbDxt8yoP75TF1vk2fzn6c43tDZfCZiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgoP8D1/cAr6hOvYYAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" tabindex="-1"></a><span class="co"># QQ图比较y的分布</span></span>
<span id="cb176-2"><a href="#cb176-2" tabindex="-1"></a><span class="fu">qqplot</span>(samples_r[, <span class="dv">2</span>], samples_rcpp[, <span class="dv">2</span>], <span class="at">main =</span> <span class="st">&quot;QQ Plot of y&quot;</span>)</span>
<span id="cb176-3"><a href="#cb176-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>结果显示两种方式生成的分布基本一样。</p>
<p>接下来比较两种方法的运算速度：</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a>benchmark_results <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb179-2"><a href="#cb179-2" tabindex="-1"></a>  <span class="at">Rcpp =</span> <span class="fu">gibbs_rcpp</span>(n_samples, n, a, b, x_init, y_init),</span>
<span id="cb179-3"><a href="#cb179-3" tabindex="-1"></a>  <span class="at">R =</span> <span class="fu">gibbs_r</span>(n_samples, n, a, b, x_init, y_init),</span>
<span id="cb179-4"><a href="#cb179-4" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">100</span></span>
<span id="cb179-5"><a href="#cb179-5" tabindex="-1"></a>)</span>
<span id="cb179-6"><a href="#cb179-6" tabindex="-1"></a></span>
<span id="cb179-7"><a href="#cb179-7" tabindex="-1"></a><span class="fu">print</span>(benchmark_results)</span></code></pre></div>
<pre><code>## Unit: microseconds
##  expr    min      lq     mean  median      uq    max neval cld
##  Rcpp  208.7  217.65  248.344  225.45  236.45 1730.1   100  a 
##     R 2346.0 2449.00 2720.068 2558.75 2729.20 4980.8   100   b</code></pre>
<p>结果显示，使用Rcpp的运算结果显著比使用R的结果好，平均时间缩短了90%。</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
